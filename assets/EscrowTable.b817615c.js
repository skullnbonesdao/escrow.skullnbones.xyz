import{g as Ht,w as dt,f as et,a as _e,e as tt,Q as ye,h as Fe,i as Ut}from"./DiscordLinkButton.adaa0a8f.js";import{a2 as re,ar as Z,as as ee,aT as vt,bs as Wt,t as G,u as b,v as i,w as te,F as ae,E as Gt,ak as se,A as V,C as M,bn as ft,G as Me,b2 as Xt,b1 as Yt,D as gt,Q as Jt,R as at,N as bt,aE as Zt,aF as ea,bb as ta,bk as lt,aM as Ne,bt as ot,aN as aa,H as mt,bu as la,aL as le,a8 as H,ah as p,bv as oa,aQ as $,aa as _t,aP as Ve,a3 as U,a4 as W,P as j,aV as na,a5 as P,ad as B,b9 as nt,a6 as S,a9 as O,aj as z,af as we,a7 as $e,ai as oe,bw as ra}from"./index.8259727a.js";import{a as Le}from"./QCardSection.faeb7beb.js";import{f as sa,a as De,b as ia,d as ua}from"./FilterEscrows.e0d8e4c8.js";import{u as Ie,a as Qe}from"./QCard.6fabafe1.js";import{f as ca,g as da,h as yt,e as va}from"./QSelect.674188de.js";function fa(e,l,o,v,r=Z,g=ee){return ga(e,l,o,v,re.Buffer.alloc(0),r,g)}function ga(e,l,o,v,r,g=Z,n=ee){const c=[{pubkey:e,isSigner:!0,isWritable:!0},{pubkey:l,isSigner:!1,isWritable:!0},{pubkey:o,isSigner:!1,isWritable:!1},{pubkey:v,isSigner:!1,isWritable:!1},{pubkey:vt.programId,isSigner:!1,isWritable:!1},{pubkey:g,isSigner:!1,isWritable:!1}];return new Wt({keys:c,programId:n,data:r})}var N=G({name:"QTd",props:{props:Object,autoWidth:Boolean,noHover:Boolean},setup(e,{slots:l}){const o=ae(),v=b(()=>"q-td"+(e.autoWidth===!0?" q-table--col-auto-width":"")+(e.noHover===!0?" q-td--no-hover":"")+" ");return()=>{if(e.props===void 0)return i("td",{class:v.value},te(l.default));const r=o.vnode.key,g=(e.props.colsMap!==void 0?e.props.colsMap[r]:null)||e.props.col;if(g===void 0)return;const{row:n}=e.props;return i("td",{class:v.value+g.__tdClass(n),style:g.__tdStyle(n)},te(l.default))}}}),Ee=G({name:"QTr",props:{props:Object,noHover:Boolean},setup(e,{slots:l}){const o=b(()=>"q-tr"+(e.props===void 0||e.props.header===!0?"":" "+e.props.__trClass)+(e.noHover===!0?" q-tr--no-hover":""));return()=>i("tr",{class:o.value},te(l.default))}}),ba=G({name:"QTh",props:{props:Object,autoWidth:Boolean},emits:["click"],setup(e,{slots:l,emit:o}){const v=ae(),{proxy:{$q:r}}=v,g=n=>{o("click",n)};return()=>{if(e.props===void 0)return i("th",{class:e.autoWidth===!0?"q-table--col-auto-width":"",onClick:g},te(l.default));let n,c;const s=v.vnode.key;if(s){if(n=e.props.colsMap[s],n===void 0)return}else n=e.props.col;if(n.sortable===!0){const a=n.align==="right"?"unshift":"push";c=Gt(l.default,[]),c[a](i(se,{class:n.__iconClass,name:r.iconSet.table.arrowUp}))}else c=te(l.default);const m={class:n.__thClass+(e.autoWidth===!0?" q-table--col-auto-width":""),style:n.headerStyle,onClick:a=>{n.sortable===!0&&e.props.sort(n),g(a)}};return i("th",m,c)}}});const ma=["horizontal","vertical","cell","none"];var _a=G({name:"QMarkupTable",props:{...Ie,dense:Boolean,flat:Boolean,bordered:Boolean,square:Boolean,wrapCells:Boolean,separator:{type:String,default:"horizontal",validator:e=>ma.includes(e)}},setup(e,{slots:l}){const o=ae(),v=Qe(e,o.proxy.$q),r=b(()=>`q-markup-table q-table__container q-table__card q-table--${e.separator}-separator`+(v.value===!0?" q-table--dark q-table__card--dark q-dark":"")+(e.dense===!0?" q-table--dense":"")+(e.flat===!0?" q-table--flat":"")+(e.bordered===!0?" q-table--bordered":"")+(e.square===!0?" q-table--square":"")+(e.wrapCells===!1?" q-table--no-wrap":""));return()=>i("div",{class:r.value},[i("table",{class:"q-table"},te(l.default))])}});function wt(e,l){return i("div",e,[i("table",{class:"q-table"},l)])}const ya={list:sa,table:_a},wa=["list","table","__qtable"];var Sa=G({name:"QVirtualScroll",props:{...ca,type:{type:String,default:"list",validator:e=>wa.includes(e)},items:{type:Array,default:()=>[]},itemsFn:Function,itemsSize:Number,scrollTarget:{default:void 0}},setup(e,{slots:l,attrs:o}){let v;const r=V(null),g=b(()=>e.itemsSize>=0&&e.itemsFn!==void 0?parseInt(e.itemsSize,10):Array.isArray(e.items)?e.items.length:0),{virtualScrollSliceRange:n,localResetVirtualScroll:c,padVirtualScroll:s,onVirtualScrollEvt:m}=da({virtualScrollLength:g,getVirtualScrollTarget:C,getVirtualScrollEl:y}),a=b(()=>{if(g.value===0)return[];const E=(L,R)=>({index:n.value.from+R,item:L});return e.itemsFn===void 0?e.items.slice(n.value.from,n.value.to).map(E):e.itemsFn(n.value.from,n.value.to-n.value.from).map(E)}),d=b(()=>"q-virtual-scroll q-virtual-scroll"+(e.virtualScrollHorizontal===!0?"--horizontal":"--vertical")+(e.scrollTarget!==void 0?"":" scroll")),u=b(()=>e.scrollTarget!==void 0?{}:{tabindex:0});M(g,()=>{c()}),M(()=>e.scrollTarget,()=>{h(),q()});function y(){return r.value.$el||r.value}function C(){return v}function q(){v=Jt(y(),e.scrollTarget),v.addEventListener("scroll",m,at.passive)}function h(){v!==void 0&&(v.removeEventListener("scroll",m,at.passive),v=void 0)}function D(){let E=s(e.type==="list"?"div":"tbody",a.value.map(l.default));return l.before!==void 0&&(E=l.before().concat(E)),bt(l.after,E)}return ft(()=>{c()}),Me(()=>{q()}),Xt(()=>{q()}),Yt(()=>{h()}),gt(()=>{h()}),()=>{if(l.default===void 0){console.error("QVirtualScroll: default scoped slot is required for rendering");return}return e.type==="__qtable"?wt({ref:r,class:"q-table__middle "+d.value},D()):i(ya[e.type],{...o,ref:r,class:[o.class,d.value],...u.value},D)}}});const ha={xs:2,sm:4,md:6,lg:10,xl:14};function rt(e,l,o){return{transform:l===!0?`translateX(${o.lang.rtl===!0?"-":""}100%) scale3d(${-e},1,1)`:`scale3d(${e},1,1)`}}var ka=G({name:"QLinearProgress",props:{...Ie,...Zt,value:{type:Number,default:0},buffer:Number,color:String,trackColor:String,reverse:Boolean,stripe:Boolean,indeterminate:Boolean,query:Boolean,rounded:Boolean,animationSpeed:{type:[String,Number],default:2100},instantFeedback:Boolean},setup(e,{slots:l}){const{proxy:o}=ae(),v=Qe(e,o.$q),r=ea(e,ha),g=b(()=>e.indeterminate===!0||e.query===!0),n=b(()=>e.reverse!==e.query),c=b(()=>({...r.value!==null?r.value:{},"--q-linear-progress-speed":`${e.animationSpeed}ms`})),s=b(()=>"q-linear-progress"+(e.color!==void 0?` text-${e.color}`:"")+(e.reverse===!0||e.query===!0?" q-linear-progress--reverse":"")+(e.rounded===!0?" rounded-borders":"")),m=b(()=>rt(e.buffer!==void 0?e.buffer:1,n.value,o.$q)),a=b(()=>`with${e.instantFeedback===!0?"out":""}-transition`),d=b(()=>`q-linear-progress__track absolute-full q-linear-progress__track--${a.value} q-linear-progress__track--${v.value===!0?"dark":"light"}`+(e.trackColor!==void 0?` bg-${e.trackColor}`:"")),u=b(()=>rt(g.value===!0?1:e.value,n.value,o.$q)),y=b(()=>`q-linear-progress__model absolute-full q-linear-progress__model--${a.value} q-linear-progress__model--${g.value===!0?"in":""}determinate`),C=b(()=>({width:`${e.value*100}%`})),q=b(()=>`q-linear-progress__stripe absolute-${e.reverse===!0?"right":"left"} q-linear-progress__stripe--${a.value}`);return()=>{const h=[i("div",{class:d.value,style:m.value}),i("div",{class:y.value,style:u.value})];return e.stripe===!0&&g.value===!1&&h.push(i("div",{class:q.value,style:C.value})),i("div",{class:s.value,style:c.value,role:"progressbar","aria-valuemin":0,"aria-valuemax":1,"aria-valuenow":e.indeterminate===!0?void 0:e.value},bt(l.default,h))}}});let ne=0;const qa={fullscreen:Boolean,noRouteFullscreenExit:Boolean},pa=["update:fullscreen","fullscreen"];function Pa(){const e=ae(),{props:l,emit:o,proxy:v}=e;let r,g,n;const c=V(!1);ta(e)===!0&&M(()=>v.$route.fullPath,()=>{l.noRouteFullscreenExit!==!0&&a()}),M(()=>l.fullscreen,d=>{c.value!==d&&s()}),M(c,d=>{o("update:fullscreen",d),o("fullscreen",d)});function s(){c.value===!0?a():m()}function m(){c.value!==!0&&(c.value=!0,n=v.$el.parentNode,n.replaceChild(g,v.$el),document.body.appendChild(v.$el),ne++,ne===1&&document.body.classList.add("q-body--fullscreen-mixin"),r={handler:a},lt.add(r))}function a(){c.value===!0&&(r!==void 0&&(lt.remove(r),r=void 0),n.replaceChild(v.$el,g),c.value=!1,ne=Math.max(0,ne-1),ne===0&&(document.body.classList.remove("q-body--fullscreen-mixin"),v.$el.scrollIntoView!==void 0&&setTimeout(()=>{v.$el.scrollIntoView()})))}return ft(()=>{g=document.createElement("span")}),Me(()=>{l.fullscreen===!0&&m()}),gt(a),Object.assign(v,{toggleFullscreen:s,setFullscreen:m,exitFullscreen:a}),{inFullscreen:c,toggleFullscreen:s}}function Ca(e,l){return new Date(e)-new Date(l)}const Ta={sortMethod:Function,binaryStateSort:Boolean,columnSortOrder:{type:String,validator:e=>e==="ad"||e==="da",default:"ad"}};function xa(e,l,o,v){const r=b(()=>{const{sortBy:c}=l.value;return c&&o.value.find(s=>s.name===c)||null}),g=b(()=>e.sortMethod!==void 0?e.sortMethod:(c,s,m)=>{const a=o.value.find(y=>y.name===s);if(a===void 0||a.field===void 0)return c;const d=m===!0?-1:1,u=typeof a.field=="function"?y=>a.field(y):y=>y[a.field];return c.sort((y,C)=>{let q=u(y),h=u(C);return a.rawSort!==void 0?a.rawSort(q,h,y,C)*d:q==null?-1*d:h==null?1*d:a.sort!==void 0?a.sort(q,h,y,C)*d:Ne(q)===!0&&Ne(h)===!0?(q-h)*d:ot(q)===!0&&ot(h)===!0?Ca(q,h)*d:typeof q=="boolean"&&typeof h=="boolean"?(q-h)*d:([q,h]=[q,h].map(D=>(D+"").toLocaleString().toLowerCase()),q<h?-1*d:q===h?0:d)})});function n(c){let s=e.columnSortOrder;if(aa(c)===!0)c.sortOrder&&(s=c.sortOrder),c=c.name;else{const d=o.value.find(u=>u.name===c);d!==void 0&&d.sortOrder&&(s=d.sortOrder)}let{sortBy:m,descending:a}=l.value;m!==c?(m=c,a=s==="da"):e.binaryStateSort===!0?a=!a:a===!0?s==="ad"?m=null:a=!1:s==="ad"?a=!0:m=null,v({sortBy:m,descending:a,page:1})}return{columnToSort:r,computedSortMethod:g,sort:n}}const Ra={filter:[String,Object],filterMethod:Function};function Ba(e,l){const o=b(()=>e.filterMethod!==void 0?e.filterMethod:(v,r,g,n)=>{const c=r?r.toLowerCase():"";return v.filter(s=>g.some(m=>{const a=n(m,s)+"";return(a==="undefined"||a==="null"?"":a.toLowerCase()).indexOf(c)!==-1}))});return M(()=>e.filter,()=>{mt(()=>{l({page:1},!0)})},{deep:!0}),{computedFilterMethod:o}}function Oa(e,l){for(const o in l)if(l[o]!==e[o])return!1;return!0}function st(e){return e.page<1&&(e.page=1),e.rowsPerPage!==void 0&&e.rowsPerPage<1&&(e.rowsPerPage=0),e}const Aa={pagination:Object,rowsPerPageOptions:{type:Array,default:()=>[5,7,10,15,20,25,50,0]},"onUpdate:pagination":[Function,Array]};function Fa(e,l){const{props:o,emit:v}=e,r=V(Object.assign({sortBy:null,descending:!1,page:1,rowsPerPage:o.rowsPerPageOptions.length!==0?o.rowsPerPageOptions[0]:5},o.pagination)),g=b(()=>{const a=o["onUpdate:pagination"]!==void 0?{...r.value,...o.pagination}:r.value;return st(a)}),n=b(()=>g.value.rowsNumber!==void 0);function c(a){s({pagination:a,filter:o.filter})}function s(a={}){mt(()=>{v("request",{pagination:a.pagination||g.value,filter:a.filter||o.filter,getCellValue:l})})}function m(a,d){const u=st({...g.value,...a});if(Oa(g.value,u)===!0){n.value===!0&&d===!0&&c(u);return}if(n.value===!0){c(u);return}o.pagination!==void 0&&o["onUpdate:pagination"]!==void 0?v("update:pagination",u):r.value=u}return{innerPagination:r,computedPagination:g,isServerSide:n,requestServerInteraction:s,setPagination:m}}function $a(e,l,o,v,r,g){const{props:n,emit:c,proxy:{$q:s}}=e,m=b(()=>v.value===!0?o.value.rowsNumber||0:g.value),a=b(()=>{const{page:R,rowsPerPage:A}=o.value;return(R-1)*A}),d=b(()=>{const{page:R,rowsPerPage:A}=o.value;return R*A}),u=b(()=>o.value.page===1),y=b(()=>o.value.rowsPerPage===0?1:Math.max(1,Math.ceil(m.value/o.value.rowsPerPage))),C=b(()=>d.value===0?!0:o.value.page>=y.value),q=b(()=>(n.rowsPerPageOptions.includes(l.value.rowsPerPage)?n.rowsPerPageOptions:[l.value.rowsPerPage].concat(n.rowsPerPageOptions)).map(A=>({label:A===0?s.lang.table.allRows:""+A,value:A})));M(y,(R,A)=>{if(R===A)return;const ie=o.value.page;R&&!ie?r({page:1}):R<ie&&r({page:R})});function h(){r({page:1})}function D(){const{page:R}=o.value;R>1&&r({page:R-1})}function E(){const{page:R,rowsPerPage:A}=o.value;d.value>0&&R*A<m.value&&r({page:R+1})}function L(){r({page:y.value})}return n["onUpdate:pagination"]!==void 0&&c("update:pagination",{...o.value}),{firstRowIndex:a,lastRowIndex:d,isFirstPage:u,isLastPage:C,pagesNumber:y,computedRowsPerPageOptions:q,computedRowsNumber:m,firstPage:h,prevPage:D,nextPage:E,lastPage:L}}const Da={selection:{type:String,default:"none",validator:e=>["single","multiple","none"].includes(e)},selected:{type:Array,default:()=>[]}},Ea=["update:selected","selection"];function Na(e,l,o,v){const r=b(()=>{const C={};return e.selected.map(v.value).forEach(q=>{C[q]=!0}),C}),g=b(()=>e.selection!=="none"),n=b(()=>e.selection==="single"),c=b(()=>e.selection==="multiple"),s=b(()=>o.value.length!==0&&o.value.every(C=>r.value[v.value(C)]===!0)),m=b(()=>s.value!==!0&&o.value.some(C=>r.value[v.value(C)]===!0)),a=b(()=>e.selected.length);function d(C){return r.value[C]===!0}function u(){l("update:selected",[])}function y(C,q,h,D){l("selection",{rows:q,added:h,keys:C,evt:D});const E=n.value===!0?h===!0?q:[]:h===!0?e.selected.concat(q):e.selected.filter(L=>C.includes(v.value(L))===!1);l("update:selected",E)}return{hasSelectionMode:g,singleSelection:n,multipleSelection:c,allRowsSelected:s,someRowsSelected:m,rowsSelectedNumber:a,isRowSelected:d,clearSelection:u,updateSelection:y}}function it(e){return Array.isArray(e)?e.slice():[]}const Va={expanded:Array},La=["update:expanded"];function Ma(e,l){const o=V(it(e.expanded));M(()=>e.expanded,n=>{o.value=it(n)});function v(n){return o.value.includes(n)}function r(n){e.expanded!==void 0?l("update:expanded",n):o.value=n}function g(n,c){const s=o.value.slice(),m=s.indexOf(n);c===!0?m===-1&&(s.push(n),r(s)):m!==-1&&(s.splice(m,1),r(s))}return{isRowExpanded:v,setExpanded:r,updateExpanded:g}}const Ia={visibleColumns:Array};function Qa(e,l,o){const v=b(()=>{if(e.columns!==void 0)return e.columns;const c=e.rows[0];return c!==void 0?Object.keys(c).map(s=>({name:s,label:s.toUpperCase(),field:s,align:Ne(c[s])?"right":"left",sortable:!0})):[]}),r=b(()=>{const{sortBy:c,descending:s}=l.value;return(e.visibleColumns!==void 0?v.value.filter(a=>a.required===!0||e.visibleColumns.includes(a.name)===!0):v.value).map(a=>{const d=a.align||"right",u=`text-${d}`;return{...a,align:d,__iconClass:`q-table__sort-icon q-table__sort-icon--${d}`,__thClass:u+(a.headerClasses!==void 0?" "+a.headerClasses:"")+(a.sortable===!0?" sortable":"")+(a.name===c?` sorted ${s===!0?"sort-desc":""}`:""),__tdStyle:a.style!==void 0?typeof a.style!="function"?()=>a.style:a.style:()=>null,__tdClass:a.classes!==void 0?typeof a.classes!="function"?()=>u+" "+a.classes:y=>u+" "+a.classes(y):()=>u}})}),g=b(()=>{const c={};return r.value.forEach(s=>{c[s.name]=s}),c}),n=b(()=>e.tableColspan!==void 0?e.tableColspan:r.value.length+(o.value===!0?1:0));return{colList:v,computedCols:r,computedColsMap:g,computedColspan:n}}const Se="q-table__bottom row items-center",St={};yt.forEach(e=>{St[e]={}});var ja=G({name:"QTable",props:{rows:{type:Array,default:()=>[]},rowKey:{type:[String,Function],default:"id"},columns:Array,loading:Boolean,iconFirstPage:String,iconPrevPage:String,iconNextPage:String,iconLastPage:String,title:String,hideHeader:Boolean,grid:Boolean,gridHeader:Boolean,dense:Boolean,flat:Boolean,bordered:Boolean,square:Boolean,separator:{type:String,default:"horizontal",validator:e=>["horizontal","vertical","cell","none"].includes(e)},wrapCells:Boolean,virtualScroll:Boolean,virtualScrollTarget:{default:void 0},...St,noDataLabel:String,noResultsLabel:String,loadingLabel:String,selectedRowsLabel:Function,rowsPerPageLabel:String,paginationLabel:Function,color:{type:String,default:"grey-8"},titleClass:[String,Array,Object],tableStyle:[String,Array,Object],tableClass:[String,Array,Object],tableHeaderStyle:[String,Array,Object],tableHeaderClass:[String,Array,Object],cardContainerClass:[String,Array,Object],cardContainerStyle:[String,Array,Object],cardStyle:[String,Array,Object],cardClass:[String,Array,Object],hideBottom:Boolean,hideSelectedBanner:Boolean,hideNoData:Boolean,hidePagination:Boolean,onRowClick:Function,onRowDblclick:Function,onRowContextmenu:Function,...Ie,...qa,...Ia,...Ra,...Aa,...Va,...Da,...Ta},emits:["request","virtualScroll",...pa,...La,...Ea],setup(e,{slots:l,emit:o}){const v=ae(),{proxy:{$q:r}}=v,g=Qe(e,r),{inFullscreen:n,toggleFullscreen:c}=Pa(),s=b(()=>typeof e.rowKey=="function"?e.rowKey:t=>t[e.rowKey]),m=V(null),a=V(null),d=b(()=>e.grid!==!0&&e.virtualScroll===!0),u=b(()=>" q-table__card"+(g.value===!0?" q-table__card--dark q-dark":"")+(e.square===!0?" q-table--square":"")+(e.flat===!0?" q-table--flat":"")+(e.bordered===!0?" q-table--bordered":"")),y=b(()=>`q-table__container q-table--${e.separator}-separator column no-wrap`+(e.grid===!0?" q-table--grid":u.value)+(g.value===!0?" q-table--dark":"")+(e.dense===!0?" q-table--dense":"")+(e.wrapCells===!1?" q-table--no-wrap":"")+(n.value===!0?" fullscreen scroll":"")),C=b(()=>y.value+(e.loading===!0?" q-table--loading":""));M(()=>e.tableStyle+e.tableClass+e.tableHeaderStyle+e.tableHeaderClass+y.value,()=>{d.value===!0&&a.value!==null&&a.value.reset()});const{innerPagination:q,computedPagination:h,isServerSide:D,requestServerInteraction:E,setPagination:L}=Fa(v,Y),{computedFilterMethod:R}=Ba(e,L),{isRowExpanded:A,setExpanded:ie,updateExpanded:ht}=Ma(e,o),he=b(()=>{let t=e.rows;if(D.value===!0||t.length===0)return t;const{sortBy:f,descending:_}=h.value;return e.filter&&(t=R.value(t,e.filter,I.value,Y)),Ct.value!==null&&(t=Tt.value(e.rows===t?t.slice():t,f,_)),t}),je=b(()=>he.value.length),K=b(()=>{let t=he.value;if(D.value===!0)return t;const{rowsPerPage:f}=h.value;return f!==0&&(ce.value===0&&e.rows!==t?t.length>de.value&&(t=t.slice(0,de.value)):t=t.slice(ce.value,de.value)),t}),{hasSelectionMode:X,singleSelection:kt,multipleSelection:ze,allRowsSelected:qt,someRowsSelected:Ke,rowsSelectedNumber:ke,isRowSelected:qe,clearSelection:pt,updateSelection:ue}=Na(e,o,K,s),{colList:Pt,computedCols:I,computedColsMap:He,computedColspan:Ue}=Qa(e,h,X),{columnToSort:Ct,computedSortMethod:Tt,sort:pe}=xa(e,h,Pt,L),{firstRowIndex:ce,lastRowIndex:de,isFirstPage:Pe,isLastPage:Ce,pagesNumber:ve,computedRowsPerPageOptions:xt,computedRowsNumber:fe,firstPage:Te,prevPage:xe,nextPage:Re,lastPage:Be}=$a(v,q,h,D,L,je),Rt=b(()=>K.value.length===0),Bt=b(()=>{const t={};return yt.forEach(f=>{t[f]=e[f]}),t.virtualScrollItemSize===void 0&&(t.virtualScrollItemSize=e.dense===!0?28:48),t});function Ot(){d.value===!0&&a.value.reset()}function At(){if(e.grid===!0)return zt();const t=e.hideHeader!==!0?Je:null;if(d.value===!0){const _=l["top-row"],w=l["bottom-row"],k={default:x=>Ge(x.item,l.body,x.index)};if(_!==void 0){const x=i("tbody",_({cols:I.value}));k.before=t===null?()=>x:()=>[t()].concat(x)}else t!==null&&(k.before=t);return w!==void 0&&(k.after=()=>i("tbody",w({cols:I.value}))),i(Sa,{ref:a,class:e.tableClass,style:e.tableStyle,...Bt.value,scrollTarget:e.virtualScrollTarget,items:K.value,type:"__qtable",tableColspan:Ue.value,onVirtualScroll:$t},k)}const f=[Dt()];return t!==null&&f.unshift(t()),wt({class:["q-table__middle scroll",e.tableClass],style:e.tableStyle},f)}function Ft(t,f){if(a.value!==null){a.value.scrollTo(t,f);return}t=parseInt(t,10);const _=m.value.querySelector(`tbody tr:nth-of-type(${t+1})`);if(_!==null){const w=m.value.querySelector(".q-table__middle.scroll"),k=_.offsetTop-e.virtualScrollStickySizeStart,x=k<w.scrollTop?"decrease":"increase";w.scrollTop=k,o("virtualScroll",{index:t,from:0,to:q.value.rowsPerPage-1,direction:x})}}function $t(t){o("virtualScroll",t)}function We(){return[i(ka,{class:"q-table__linear-progress",color:e.color,dark:g.value,indeterminate:!0,trackColor:"transparent"})]}function Ge(t,f,_){const w=s.value(t),k=qe(w);if(f!==void 0)return f(Xe({key:w,row:t,pageIndex:_,__trClass:k?"selected":""}));const x=l["body-cell"],T=I.value.map(F=>{const be=l[`body-cell-${F.name}`],me=be!==void 0?be:x;return me!==void 0?me(Et({key:w,row:t,pageIndex:_,col:F})):i("td",{class:F.__tdClass(t),style:F.__tdStyle(t)},Y(F,t))});if(X.value===!0){const F=l["body-selection"],be=F!==void 0?F(Nt({key:w,row:t,pageIndex:_})):[i(De,{modelValue:k,color:e.color,dark:g.value,dense:e.dense,"onUpdate:modelValue":(me,Kt)=>{ue([w],[t],me,Kt)}})];T.unshift(i("td",{class:"q-table--col-auto-width"},be))}const Q={key:w,class:{selected:k}};return e.onRowClick!==void 0&&(Q.class["cursor-pointer"]=!0,Q.onClick=F=>{o("RowClick",F,t,_)}),e.onRowDblclick!==void 0&&(Q.class["cursor-pointer"]=!0,Q.onDblclick=F=>{o("RowDblclick",F,t,_)}),e.onRowContextmenu!==void 0&&(Q.class["cursor-pointer"]=!0,Q.onContextmenu=F=>{o("RowContextmenu",F,t,_)}),i("tr",Q,T)}function Dt(){const t=l.body,f=l["top-row"],_=l["bottom-row"];let w=K.value.map((k,x)=>Ge(k,t,x));return f!==void 0&&(w=f({cols:I.value}).concat(w)),_!==void 0&&(w=w.concat(_({cols:I.value}))),i("tbody",w)}function Xe(t){return Oe(t),t.cols=t.cols.map(f=>le({...f},"value",()=>Y(f,t.row))),t}function Et(t){return Oe(t),le(t,"value",()=>Y(t.col,t.row)),t}function Nt(t){return Oe(t),t}function Oe(t){Object.assign(t,{cols:I.value,colsMap:He.value,sort:pe,rowIndex:ce.value+t.pageIndex,color:e.color,dark:g.value,dense:e.dense}),X.value===!0&&le(t,"selected",()=>qe(t.key),(f,_)=>{ue([t.key],[t.row],f,_)}),le(t,"expand",()=>A(t.key),f=>{ht(t.key,f)})}function Y(t,f){const _=typeof t.field=="function"?t.field(f):f[t.field];return t.format!==void 0?t.format(_,f):_}const J=b(()=>({pagination:h.value,pagesNumber:ve.value,isFirstPage:Pe.value,isLastPage:Ce.value,firstPage:Te,prevPage:xe,nextPage:Re,lastPage:Be,inFullscreen:n.value,toggleFullscreen:c}));function Vt(){const t=l.top,f=l["top-left"],_=l["top-right"],w=l["top-selection"],k=X.value===!0&&w!==void 0&&ke.value>0,x="q-table__top relative-position row items-center";if(t!==void 0)return i("div",{class:x},[t(J.value)]);let T;if(k===!0?T=w(J.value).slice():(T=[],f!==void 0?T.push(i("div",{class:"q-table__control"},[f(J.value)])):e.title&&T.push(i("div",{class:"q-table__control"},[i("div",{class:["q-table__title",e.titleClass]},e.title)]))),_!==void 0&&(T.push(i("div",{class:"q-table__separator col"})),T.push(i("div",{class:"q-table__control"},[_(J.value)]))),T.length!==0)return i("div",{class:x},T)}const Ye=b(()=>Ke.value===!0?null:qt.value);function Je(){const t=Lt();return e.loading===!0&&l.loading===void 0&&t.push(i("tr",{class:"q-table__progress"},[i("th",{class:"relative-position",colspan:Ue.value},We())])),i("thead",t)}function Lt(){const t=l.header,f=l["header-cell"];if(t!==void 0)return t(Ae({header:!0})).slice();const _=I.value.map(w=>{const k=l[`header-cell-${w.name}`],x=k!==void 0?k:f,T=Ae({col:w});return x!==void 0?x(T):i(ba,{key:w.name,props:T},()=>w.label)});if(kt.value===!0&&e.grid!==!0)_.unshift(i("th",{class:"q-table--col-auto-width"}," "));else if(ze.value===!0){const w=l["header-selection"],k=w!==void 0?w(Ae({})):[i(De,{color:e.color,modelValue:Ye.value,dark:g.value,dense:e.dense,"onUpdate:modelValue":Ze})];_.unshift(i("th",{class:"q-table--col-auto-width"},k))}return[i("tr",{class:e.tableHeaderClass,style:e.tableHeaderStyle},_)]}function Ae(t){return Object.assign(t,{cols:I.value,sort:pe,colsMap:He.value,color:e.color,dark:g.value,dense:e.dense}),ze.value===!0&&le(t,"selected",()=>Ye.value,Ze),t}function Ze(t){Ke.value===!0&&(t=!1),ue(K.value.map(s.value),K.value,t)}const ge=b(()=>{const t=[e.iconFirstPage||r.iconSet.table.firstPage,e.iconPrevPage||r.iconSet.table.prevPage,e.iconNextPage||r.iconSet.table.nextPage,e.iconLastPage||r.iconSet.table.lastPage];return r.lang.rtl===!0?t.reverse():t});function Mt(){if(e.hideBottom===!0)return;if(Rt.value===!0){if(e.hideNoData===!0)return;const _=e.loading===!0?e.loadingLabel||r.lang.table.loading:e.filter?e.noResultsLabel||r.lang.table.noResults:e.noDataLabel||r.lang.table.noData,w=l["no-data"],k=w!==void 0?[w({message:_,icon:r.iconSet.table.warning,filter:e.filter})]:[i(se,{class:"q-table__bottom-nodata-icon",name:r.iconSet.table.warning}),_];return i("div",{class:Se+" q-table__bottom--nodata"},k)}const t=l.bottom;if(t!==void 0)return i("div",{class:Se},[t(J.value)]);const f=e.hideSelectedBanner!==!0&&X.value===!0&&ke.value>0?[i("div",{class:"q-table__control"},[i("div",[(e.selectedRowsLabel||r.lang.table.selectedRecords)(ke.value)])])]:[];if(e.hidePagination!==!0)return i("div",{class:Se+" justify-end"},Qt(f));if(f.length!==0)return i("div",{class:Se},f)}function It(t){L({page:1,rowsPerPage:t.value})}function Qt(t){let f;const{rowsPerPage:_}=h.value,w=e.paginationLabel||r.lang.table.pagination,k=l.pagination,x=e.rowsPerPageOptions.length>1;if(t.push(i("div",{class:"q-table__separator col"})),x===!0&&t.push(i("div",{class:"q-table__control"},[i("span",{class:"q-table__bottom-item"},[e.rowsPerPageLabel||r.lang.table.recordsPerPage]),i(va,{class:"q-table__select inline q-table__bottom-item",color:e.color,modelValue:_,options:xt.value,displayValue:_===0?r.lang.table.allRows:_,dark:g.value,borderless:!0,dense:!0,optionsDense:!0,optionsCover:!0,"onUpdate:modelValue":It})])),k!==void 0)f=k(J.value);else if(f=[i("span",_!==0?{class:"q-table__bottom-item"}:{},[_?w(ce.value+1,Math.min(de.value,fe.value),fe.value):w(1,je.value,fe.value)])],_!==0&&ve.value>1){const T={color:e.color,round:!0,dense:!0,flat:!0};e.dense===!0&&(T.size="sm"),ve.value>2&&f.push(i(H,{key:"pgFirst",...T,icon:ge.value[0],disable:Pe.value,onClick:Te})),f.push(i(H,{key:"pgPrev",...T,icon:ge.value[1],disable:Pe.value,onClick:xe}),i(H,{key:"pgNext",...T,icon:ge.value[2],disable:Ce.value,onClick:Re})),ve.value>2&&f.push(i(H,{key:"pgLast",...T,icon:ge.value[3],disable:Ce.value,onClick:Be}))}return t.push(i("div",{class:"q-table__control"},f)),t}function jt(){const t=e.gridHeader===!0?[i("table",{class:"q-table"},[Je()])]:e.loading===!0&&l.loading===void 0?We():void 0;return i("div",{class:"q-table__middle"},t)}function zt(){const t=l.item!==void 0?l.item:f=>{const _=f.cols.map(k=>i("div",{class:"q-table__grid-item-row"},[i("div",{class:"q-table__grid-item-title"},[k.label]),i("div",{class:"q-table__grid-item-value"},[k.value])]));if(X.value===!0){const k=l["body-selection"],x=k!==void 0?k(f):[i(De,{modelValue:f.selected,color:e.color,dark:g.value,dense:e.dense,"onUpdate:modelValue":(T,Q)=>{ue([f.key],[f.row],T,Q)}})];_.unshift(i("div",{class:"q-table__grid-item-row"},x),i(Le,{dark:g.value}))}const w={class:["q-table__grid-item-card"+u.value,e.cardClass],style:e.cardStyle};return(e.onRowClick!==void 0||e.onRowDblclick!==void 0)&&(w.class[0]+=" cursor-pointer",e.onRowClick!==void 0&&(w.onClick=k=>{o("RowClick",k,f.row,f.pageIndex)}),e.onRowDblclick!==void 0&&(w.onDblclick=k=>{o("RowDblclick",k,f.row,f.pageIndex)})),i("div",{class:"q-table__grid-item col-xs-12 col-sm-6 col-md-4 col-lg-3"+(f.selected===!0?" q-table__grid-item--selected":"")},[i("div",w,_)])};return i("div",{class:["q-table__grid-content row",e.cardContainerClass],style:e.cardContainerStyle},K.value.map((f,_)=>t(Xe({key:s.value(f),row:f,pageIndex:_}))))}return Object.assign(v.proxy,{requestServerInteraction:E,setPagination:L,firstPage:Te,prevPage:xe,nextPage:Re,lastPage:Be,isRowSelected:qe,clearSelection:pt,isRowExpanded:A,setExpanded:ie,sort:pe,resetVirtualScroll:Ot,scrollTo:Ft,getCellValue:Y}),la(v.proxy,{filteredSortedRows:()=>he.value,computedRows:()=>K.value,computedRowsNumber:()=>fe.value}),()=>{const t=[Vt()],f={ref:m,class:C.value};return e.grid===!0?t.push(jt()):Object.assign(f,{class:[f.class,e.cardClass],style:e.cardStyle}),t.push(At(),Mt()),e.loading===!0&&l.loading!==void 0&&t.push(l.loading()),i("div",f,t)}}});async function ut(e,l){const o=await Ht(e,l,!1,Z,ee);return await p().connection.getAccountInfo(o)===null?(console.log("Associated token account does NOT exist:",o.toString()),!1):(console.log("Associated token account exists:",o.toString()),!0)}async function ct(e,l){const o=new oa().add(fa($().publicKey.value,e,$().publicKey.value,l)),v=await $().sendTransaction(o,p().connection);console.log(v),await dt(p().connection,v)}const za=_t({__name:"CancelEscrowButton",props:["escrow_address","label"],setup(e){const l=e,o=Ve();async function v(){const{pg_escrow:r}=na();let g;g=o.notify({group:!1,timeout:0,spinner:!0,message:"Sending TX..."});try{const n=await r.value.account.escrow.fetch(l.escrow_address),c=n.seed,s=j.findProgramAddressSync([re.Buffer.from("escrow"),$().publicKey.value.toBytes(),c.toArrayLike(re.Buffer).reverse()],r.value.programId)[0],m=j.findProgramAddressSync([re.Buffer.from("vault"),s.toBuffer()],r.value.programId)[0],a=j.findProgramAddressSync([re.Buffer.from("auth"),s.toBuffer()],r.value.programId)[0],d=et(new j(n.depositToken),$().publicKey.value,void 0,Z,ee);await ut(new j(n.depositToken),$().publicKey.value)||await ct(d,new j(n.depositToken));const u=et(new j(n.requestToken),$().publicKey.value,void 0,Z,ee);await ut(new j(n.requestToken),$().publicKey.value)||await ct(u,new j(n.requestToken));let y=await r.value.methods.cancel().accounts({maker:$().publicKey.value,makerAta:d,depositToken:n.depositToken,makerAtaRequest:u,makerTokenRequest:n.requestToken,auth:a,escrow:s,vault:m,tokenProgram:Z,associatedTokenProgram:ee,systemProgram:vt.programId});y=await y.rpc(),console.log(`TX_Signature = ${y}`),await dt(p().connection,y),g({type:"positive",icon:"done",spinner:!1,message:"Transaction confirmed!",timeout:2500})}catch(n){g({type:"negative",icon:"error",spinner:!1,message:n.toString(),timeout:5e3}),console.error(n)}}return(r,g)=>(U(),W(H,{icon:"close",class:"col",color:"primary",label:e.label,onClick:g[0]||(g[0]=n=>{v().then(()=>{console.info("build_tx executed")})})},null,8,["label"]))}});const Ka={class:"col items-center"},Ha={class:"row"},Ua=O("div",{class:"q-my-md"},null,-1),Wa={class:"row"},Ga={class:"col"},Xa={class:"text-right text-h6"},Ya={class:"col text-right text-h6"},Ja={class:"col items-center q-gutter-x-sm"},Za={style:{"font-size":"10px"}},el={class:"col items-center q-gutter-x-sm"},tl={style:{"font-size":"10px"}},al={class:"row q-gutter-x-sm"},ll={class:"col text-subtitle1 text-weight-bold text-right"},ol={class:"col-1"},nl={class:"row q-gutter-x-sm"},rl={class:"col text-subtitle1 text-weight-bold text-right"},sl={class:"col-1"},gl=_t({__name:"EscrowTable",props:["title","escrow_filter","show_close_button"],setup(e){const l=e,o=V(!1);Ve(),b(()=>{var m,a,d;let s=p().escrows;switch(l.escrow_filter){case"p2p":s=(m=p().escrows)==null?void 0:m.filter(u=>{var y,C;return u.account.recipient.toString()!=nt.toString()&&(u.account.maker.toString()==((y=$().publicKey.value)==null?void 0:y.toString())||u.account.recipient.toString()==((C=$().publicKey.value)==null?void 0:C.toString()))});break;case"b2b":s=(a=p().escrows)==null?void 0:a.filter(u=>u.account.onlyWhitelist==!0);break;default:s=(d=p().escrows)==null?void 0:d.filter(u=>u.account.recipient.toString()==nt.toString()&&u.account.onlyWhitelist!=!0&&u.account.tokensDepositRemaining.toNumber()>0);break}return c.value&&(n.value.some(u=>u=="buying")&&(console.log(c.value.mint.toString()),s=s==null?void 0:s.filter(u=>u.account.depositToken.toString()==c.value.mint.toString())),n.value.some(u=>u=="selling")&&(console.log(c.value.mint.toString()),s=s==null?void 0:s.filter(u=>u.account.requestToken.toString()===c.value.mint.toString()))),s}),M(()=>p().is_initialized,async()=>{await p().load_all_escrows()}),Me(async()=>{p().is_initialized&&await p().load_all_escrows()});function v(s){var m;l.show_close_button?(p().escrow_selected=s,o.value=!o.value):s.publicKey!=((m=p().escrow_selected)==null?void 0:m.publicKey)?(p().escrow_selected=s,p().showRightDrawer=!0):p().showRightDrawer=!p().showRightDrawer}const r=V({rowsPerPage:0}),g=V([{name:"sides",label:""},{name:"amounts",label:"Amounts"},{name:"icons",label:"Tokens",align:"center",style:"width: 50px"},{name:"price",label:"Price per Unit",align:"center"},{name:"balance",label:"",style:"width: 20px"},{name:"expire",label:"",style:"width: 20px"},{name:"creator",label:"",style:"width: 20px"},{name:"state",label:"",style:"width: 20px"},{name:"take",label:"",style:"width: 20px"}]);V([{label:"Buying",value:"buying"},{label:"Selling",value:"selling"}]);const n=V([]),c=V();return(s,m)=>(U(),W(ja,{flat:"",title:l.title,rows:B(p)().escrows_filtered,columns:g.value,"row-key":"name",filter:s.filter,pagination:r.value,"onUpdate:pagination":m[0]||(m[0]=a=>r.value=a),"rows-per-page-options":[0]},{top:P(()=>[]),body:P(a=>[S(Ee,{props:a,onClick:d=>v(a.row)},{default:P(()=>[S(N,{key:"sides",props:a},{default:P(()=>[O("div",Ka,[O("div",Ha,[S(_e),S(tt,{outline:"",label:"TAKES",color:"red",rounded:""}),S(_e)]),Ua,O("div",Wa,[S(_e),S(tt,{outline:"",label:"GIVES",color:"green",rounded:""}),S(_e)])])]),_:2},1032,["props"]),S(N,{key:"amounts",props:a},{default:P(()=>{var d,u;return[O("div",Ga,[O("div",Xa,z((a.row.account.tokensDepositRemaining*10**-((d=B(p)().token_list.find(y=>y.address==a.row.account.depositToken.toString()))==null?void 0:d.decimals)*a.row.account.price).toFixed(3)),1),S(Le,{class:"q-my-sm"}),O("div",Ya,z((a.row.account.tokensDepositRemaining*Math.pow(10,-((u=B(p)().token_list.find(y=>y.address==a.row.account.depositToken.toString()))==null?void 0:u.decimals))).toFixed(3)),1)])]}),_:2},1032,["props"]),S(N,{key:"icons",props:a},{default:P(()=>{var d;return[O("div",Ja,[S(we,{size:"md",color:"white"},{default:P(()=>{var u;return[S(ye,{src:((u=B(p)().token_list.find(y=>y.address==a.row.account.requestToken.toString()))==null?void 0:u.logoURI)??"unknown.png"},null,8,["src"])]}),_:2},1024),O("p",Za,z(B(p)().token_list.find(u=>u.address==a.row.account.requestToken.toString()).symbol),1)]),O("div",el,[S(we,{size:"md",color:"white"},{default:P(()=>{var u;return[S(ye,{src:((u=B(p)().token_list.find(y=>y.address==a.row.account.depositToken.toString()))==null?void 0:u.logoURI)??"unknown.png"},null,8,["src"])]}),_:2},1024),O("div",tl,z((d=B(p)().token_list.find(u=>u.address==a.row.account.depositToken.toString()))==null?void 0:d.symbol),1)])]}),_:2},1032,["props"]),S(N,{key:"price",props:a,class:"col q-gutter-x-sm"},{default:P(()=>[O("div",al,[O("div",ll,z(a.row.account.price.toFixed(5)),1),O("div",ol,[S(we,{size:"sm",color:"white"},{default:P(()=>{var d;return[S(ye,{src:((d=B(p)().token_list.find(u=>u.address==a.row.account.requestToken.toString()))==null?void 0:d.logoURI)??"unknown.png"},null,8,["src"])]}),_:2},1024)])]),O("div",nl,[O("div",rl,z((1/a.row.account.price).toFixed(5)),1),O("div",sl,[S(we,{size:"sm",color:"white"},{default:P(()=>{var d;return[S(ye,{src:((d=B(p)().token_list.find(u=>u.address==a.row.account.depositToken.toString()))==null?void 0:d.logoURI)??"unknown.png"},null,8,["src"])]}),_:2},1024)])])]),_:2},1032,["props"]),S(N,{key:"balance",props:a},{default:P(()=>[S(se,{size:"sm",name:"balance",color:a.row.account.allowPartialFill?"purple":"grey"},{default:P(()=>[S(Fe,null,{default:P(()=>[$e("Partial fill "+z(a.row.account.allowPartialFill?"":"NOT ")+" allowed",1)]),_:2},1024)]),_:2},1032,["color"])]),_:2},1032,["props"]),S(N,{key:"expire",props:a},{default:P(()=>[S(se,{size:"sm",name:"timer",color:a.row.account.expireTimestamp>0?"orange":"grey"},{default:P(()=>[S(Fe,null,{default:P(()=>[$e("Will "+z(a.row.account.expireTimestamp>0?"":"NOT ")+" expire",1)]),_:2},1024)]),_:2},1032,["color"])]),_:2},1032,["props"]),S(N,{key:"creator",props:a},{default:P(()=>{var d;return[S(se,{size:"sm",name:"design_services",color:a.row.account.maker.toString()==((d=B($)().publicKey.value)==null?void 0:d.toString())?"orange":"grey"},{default:P(()=>[S(Fe,null,{default:P(()=>{var u;return[$e("You are "+z(a.row.account.maker.toString()==((u=B($)().publicKey.value)==null?void 0:u.toString())?"":"NOT ")+" the creator",1)]}),_:2},1024)]),_:2},1032,["color"])]}),_:2},1032,["props"]),S(N,{key:"state",props:a},{default:P(()=>[S(Ut,{escrow:a.row},null,8,["escrow"])]),_:2},1032,["props"]),e.show_close_button?oe("",!0):(U(),W(N,{key:"take",props:a},{default:P(()=>[S(H,{color:"primary",icon:"send"})]),_:2},1032,["props"])),e.show_close_button?(U(),W(N,{key:"take",props:a},{default:P(()=>[S(H,{color:"primary",icon:"info"})]),_:2},1032,["props"])):oe("",!0)]),_:2},1032,["props","onClick"]),o.value&&a.row.publicKey==B(p)().escrow_selected.publicKey.toString()?(U(),W(Ee,{key:0,props:a},{default:P(()=>[S(N,{colspan:"100%"},{default:P(()=>[S(ia,{class:"bg-dark",align:"justify"},{default:P(()=>{var d;return[S(H,{class:"col",color:"primary",label:"Expand offer",name:"tab_expand",icon:"open_in_full",to:"view/"+((d=B(p)().escrow_selected)==null?void 0:d.publicKey)},null,8,["to"]),S(Le,{vertical:""}),S(za,{escrow_address:a.row.publicKey,label:`${a.row.account.tokensDepositRemaining>0?"Cancel Offer":"Close Accounts"} (+${B(ra)}sol)`},null,8,["escrow_address","label"])]}),_:2},1024)]),_:2},1024)]),_:2},1032,["props"])):oe("",!0),B(Ve)().screen.lt.md&&B(p)().showRightDrawer&&a.row.publicKey==B(p)().escrow_selected.publicKey.toString()?(U(),W(Ee,{key:1,"no-hover":"",props:a},{default:P(()=>[e.show_close_button?oe("",!0):(U(),W(N,{key:0,colspan:"100%",class:"bg-dark q-ma-none q-pa-none"},{default:P(()=>[S(ua)]),_:1}))]),_:2},1032,["props"])):oe("",!0)]),_:1},8,["title","rows","columns","filter","pagination"]))}});export{gl as _,ut as c,ct as m};
