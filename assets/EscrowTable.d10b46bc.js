import{h as Je,i as et,m as tt,w as Qt,g as lt,Q as be,j as Oe,k as Kt}from"./DiscordLinkButton.599e2ac0.js";import{t as G,u as b,v as i,w as J,F as ee,E as It,af as ne,A as L,C as M,bn as ct,G as Ne,b2 as Ht,b1 as Ut,D as dt,aF as Wt,b0 as at,N as vt,aC as Gt,aD as Xt,bb as Yt,bk as ot,aL as Le,bw as nt,aM as Zt,H as ft,bx as Jt,aK as te,a3 as H,a5 as gt,aQ as Ve,Z as U,$ as W,P as Q,Y as me,aP as N,am as Fe,an as $e,ao as el,ac as C,aU as tl,a0 as P,a8 as O,b9 as rt,a1 as S,a4 as R,aa as _e,ae as K,a2 as De,ad as le,a7 as ll,by as al}from"./index.fa72cd88.js";import{a as oe}from"./QCardSection.43a66bbb.js";import{e as ol,a as Ae,b as nl,d as rl}from"./FilterEscrows.70f687ae.js";import{u as Me,a as je}from"./QCard.d46cfa14.js";import{f as sl,g as il,h as bt,e as ul}from"./QSelect.f2994c30.js";var E=G({name:"QTd",props:{props:Object,autoWidth:Boolean,noHover:Boolean},setup(e,{slots:a}){const o=ee(),g=b(()=>"q-td"+(e.autoWidth===!0?" q-table--col-auto-width":"")+(e.noHover===!0?" q-td--no-hover":"")+" ");return()=>{if(e.props===void 0)return i("td",{class:g.value},J(a.default));const r=o.vnode.key,f=(e.props.colsMap!==void 0?e.props.colsMap[r]:null)||e.props.col;if(f===void 0)return;const{row:n}=e.props;return i("td",{class:g.value+f.__tdClass(n),style:f.__tdStyle(n)},J(a.default))}}}),Ee=G({name:"QTr",props:{props:Object,noHover:Boolean},setup(e,{slots:a}){const o=b(()=>"q-tr"+(e.props===void 0||e.props.header===!0?"":" "+e.props.__trClass)+(e.noHover===!0?" q-tr--no-hover":""));return()=>i("tr",{class:o.value},J(a.default))}}),cl=G({name:"QTh",props:{props:Object,autoWidth:Boolean},emits:["click"],setup(e,{slots:a,emit:o}){const g=ee(),{proxy:{$q:r}}=g,f=n=>{o("click",n)};return()=>{if(e.props===void 0)return i("th",{class:e.autoWidth===!0?"q-table--col-auto-width":"",onClick:f},J(a.default));let n,d;const s=g.vnode.key;if(s){if(n=e.props.colsMap[s],n===void 0)return}else n=e.props.col;if(n.sortable===!0){const l=n.align==="right"?"unshift":"push";d=It(a.default,[]),d[l](i(ne,{class:n.__iconClass,name:r.iconSet.table.arrowUp}))}else d=J(a.default);const m={class:n.__thClass+(e.autoWidth===!0?" q-table--col-auto-width":""),style:n.headerStyle,onClick:l=>{n.sortable===!0&&e.props.sort(n),f(l)}};return i("th",m,d)}}});const dl=["horizontal","vertical","cell","none"];var vl=G({name:"QMarkupTable",props:{...Me,dense:Boolean,flat:Boolean,bordered:Boolean,square:Boolean,wrapCells:Boolean,separator:{type:String,default:"horizontal",validator:e=>dl.includes(e)}},setup(e,{slots:a}){const o=ee(),g=je(e,o.proxy.$q),r=b(()=>`q-markup-table q-table__container q-table__card q-table--${e.separator}-separator`+(g.value===!0?" q-table--dark q-table__card--dark q-dark":"")+(e.dense===!0?" q-table--dense":"")+(e.flat===!0?" q-table--flat":"")+(e.bordered===!0?" q-table--bordered":"")+(e.square===!0?" q-table--square":"")+(e.wrapCells===!1?" q-table--no-wrap":""));return()=>i("div",{class:r.value},[i("table",{class:"q-table"},J(a.default))])}});function mt(e,a){return i("div",e,[i("table",{class:"q-table"},a)])}const fl={list:ol,table:vl},gl=["list","table","__qtable"];var bl=G({name:"QVirtualScroll",props:{...sl,type:{type:String,default:"list",validator:e=>gl.includes(e)},items:{type:Array,default:()=>[]},itemsFn:Function,itemsSize:Number,scrollTarget:{default:void 0}},setup(e,{slots:a,attrs:o}){let g;const r=L(null),f=b(()=>e.itemsSize>=0&&e.itemsFn!==void 0?parseInt(e.itemsSize,10):Array.isArray(e.items)?e.items.length:0),{virtualScrollSliceRange:n,localResetVirtualScroll:d,padVirtualScroll:s,onVirtualScrollEvt:m}=il({virtualScrollLength:f,getVirtualScrollTarget:p,getVirtualScrollEl:y}),l=b(()=>{if(f.value===0)return[];const A=(V,B)=>({index:n.value.from+B,item:V});return e.itemsFn===void 0?e.items.slice(n.value.from,n.value.to).map(A):e.itemsFn(n.value.from,n.value.to-n.value.from).map(A)}),c=b(()=>"q-virtual-scroll q-virtual-scroll"+(e.virtualScrollHorizontal===!0?"--horizontal":"--vertical")+(e.scrollTarget!==void 0?"":" scroll")),u=b(()=>e.scrollTarget!==void 0?{}:{tabindex:0});M(f,()=>{d()}),M(()=>e.scrollTarget,()=>{h(),q()});function y(){return r.value.$el||r.value}function p(){return g}function q(){g=Wt(y(),e.scrollTarget),g.addEventListener("scroll",m,at.passive)}function h(){g!==void 0&&(g.removeEventListener("scroll",m,at.passive),g=void 0)}function D(){let A=s(e.type==="list"?"div":"tbody",l.value.map(a.default));return a.before!==void 0&&(A=a.before().concat(A)),vt(a.after,A)}return ct(()=>{d()}),Ne(()=>{q()}),Ht(()=>{q()}),Ut(()=>{h()}),dt(()=>{h()}),()=>{if(a.default===void 0){console.error("QVirtualScroll: default scoped slot is required for rendering");return}return e.type==="__qtable"?mt({ref:r,class:"q-table__middle "+c.value},D()):i(fl[e.type],{...o,ref:r,class:[o.class,c.value],...u.value},D)}}});const ml={xs:2,sm:4,md:6,lg:10,xl:14};function st(e,a,o){return{transform:a===!0?`translateX(${o.lang.rtl===!0?"-":""}100%) scale3d(${-e},1,1)`:`scale3d(${e},1,1)`}}var _l=G({name:"QLinearProgress",props:{...Me,...Gt,value:{type:Number,default:0},buffer:Number,color:String,trackColor:String,reverse:Boolean,stripe:Boolean,indeterminate:Boolean,query:Boolean,rounded:Boolean,animationSpeed:{type:[String,Number],default:2100},instantFeedback:Boolean},setup(e,{slots:a}){const{proxy:o}=ee(),g=je(e,o.$q),r=Xt(e,ml),f=b(()=>e.indeterminate===!0||e.query===!0),n=b(()=>e.reverse!==e.query),d=b(()=>({...r.value!==null?r.value:{},"--q-linear-progress-speed":`${e.animationSpeed}ms`})),s=b(()=>"q-linear-progress"+(e.color!==void 0?` text-${e.color}`:"")+(e.reverse===!0||e.query===!0?" q-linear-progress--reverse":"")+(e.rounded===!0?" rounded-borders":"")),m=b(()=>st(e.buffer!==void 0?e.buffer:1,n.value,o.$q)),l=b(()=>`with${e.instantFeedback===!0?"out":""}-transition`),c=b(()=>`q-linear-progress__track absolute-full q-linear-progress__track--${l.value} q-linear-progress__track--${g.value===!0?"dark":"light"}`+(e.trackColor!==void 0?` bg-${e.trackColor}`:"")),u=b(()=>st(f.value===!0?1:e.value,n.value,o.$q)),y=b(()=>`q-linear-progress__model absolute-full q-linear-progress__model--${l.value} q-linear-progress__model--${f.value===!0?"in":""}determinate`),p=b(()=>({width:`${e.value*100}%`})),q=b(()=>`q-linear-progress__stripe absolute-${e.reverse===!0?"right":"left"} q-linear-progress__stripe--${l.value}`);return()=>{const h=[i("div",{class:c.value,style:m.value}),i("div",{class:y.value,style:u.value})];return e.stripe===!0&&f.value===!1&&h.push(i("div",{class:q.value,style:p.value})),i("div",{class:s.value,style:d.value,role:"progressbar","aria-valuemin":0,"aria-valuemax":1,"aria-valuenow":e.indeterminate===!0?void 0:e.value},vt(a.default,h))}}});let ae=0;const yl={fullscreen:Boolean,noRouteFullscreenExit:Boolean},wl=["update:fullscreen","fullscreen"];function Sl(){const e=ee(),{props:a,emit:o,proxy:g}=e;let r,f,n;const d=L(!1);Yt(e)===!0&&M(()=>g.$route.fullPath,()=>{a.noRouteFullscreenExit!==!0&&l()}),M(()=>a.fullscreen,c=>{d.value!==c&&s()}),M(d,c=>{o("update:fullscreen",c),o("fullscreen",c)});function s(){d.value===!0?l():m()}function m(){d.value!==!0&&(d.value=!0,n=g.$el.parentNode,n.replaceChild(f,g.$el),document.body.appendChild(g.$el),ae++,ae===1&&document.body.classList.add("q-body--fullscreen-mixin"),r={handler:l},ot.add(r))}function l(){d.value===!0&&(r!==void 0&&(ot.remove(r),r=void 0),n.replaceChild(g.$el,f),d.value=!1,ae=Math.max(0,ae-1),ae===0&&(document.body.classList.remove("q-body--fullscreen-mixin"),g.$el.scrollIntoView!==void 0&&setTimeout(()=>{g.$el.scrollIntoView()})))}return ct(()=>{f=document.createElement("span")}),Ne(()=>{a.fullscreen===!0&&m()}),dt(l),Object.assign(g,{toggleFullscreen:s,setFullscreen:m,exitFullscreen:l}),{inFullscreen:d,toggleFullscreen:s}}function hl(e,a){return new Date(e)-new Date(a)}const kl={sortMethod:Function,binaryStateSort:Boolean,columnSortOrder:{type:String,validator:e=>e==="ad"||e==="da",default:"ad"}};function ql(e,a,o,g){const r=b(()=>{const{sortBy:d}=a.value;return d&&o.value.find(s=>s.name===d)||null}),f=b(()=>e.sortMethod!==void 0?e.sortMethod:(d,s,m)=>{const l=o.value.find(y=>y.name===s);if(l===void 0||l.field===void 0)return d;const c=m===!0?-1:1,u=typeof l.field=="function"?y=>l.field(y):y=>y[l.field];return d.sort((y,p)=>{let q=u(y),h=u(p);return l.rawSort!==void 0?l.rawSort(q,h,y,p)*c:q==null?-1*c:h==null?1*c:l.sort!==void 0?l.sort(q,h,y,p)*c:Le(q)===!0&&Le(h)===!0?(q-h)*c:nt(q)===!0&&nt(h)===!0?hl(q,h)*c:typeof q=="boolean"&&typeof h=="boolean"?(q-h)*c:([q,h]=[q,h].map(D=>(D+"").toLocaleString().toLowerCase()),q<h?-1*c:q===h?0:c)})});function n(d){let s=e.columnSortOrder;if(Zt(d)===!0)d.sortOrder&&(s=d.sortOrder),d=d.name;else{const c=o.value.find(u=>u.name===d);c!==void 0&&c.sortOrder&&(s=c.sortOrder)}let{sortBy:m,descending:l}=a.value;m!==d?(m=d,l=s==="da"):e.binaryStateSort===!0?l=!l:l===!0?s==="ad"?m=null:l=!1:s==="ad"?l=!0:m=null,g({sortBy:m,descending:l,page:1})}return{columnToSort:r,computedSortMethod:f,sort:n}}const Cl={filter:[String,Object],filterMethod:Function};function Pl(e,a){const o=b(()=>e.filterMethod!==void 0?e.filterMethod:(g,r,f,n)=>{const d=r?r.toLowerCase():"";return g.filter(s=>f.some(m=>{const l=n(m,s)+"";return(l==="undefined"||l==="null"?"":l.toLowerCase()).indexOf(d)!==-1}))});return M(()=>e.filter,()=>{ft(()=>{a({page:1},!0)})},{deep:!0}),{computedFilterMethod:o}}function pl(e,a){for(const o in a)if(a[o]!==e[o])return!1;return!0}function it(e){return e.page<1&&(e.page=1),e.rowsPerPage!==void 0&&e.rowsPerPage<1&&(e.rowsPerPage=0),e}const xl={pagination:Object,rowsPerPageOptions:{type:Array,default:()=>[5,7,10,15,20,25,50,0]},"onUpdate:pagination":[Function,Array]};function Tl(e,a){const{props:o,emit:g}=e,r=L(Object.assign({sortBy:null,descending:!1,page:1,rowsPerPage:o.rowsPerPageOptions.length!==0?o.rowsPerPageOptions[0]:5},o.pagination)),f=b(()=>{const l=o["onUpdate:pagination"]!==void 0?{...r.value,...o.pagination}:r.value;return it(l)}),n=b(()=>f.value.rowsNumber!==void 0);function d(l){s({pagination:l,filter:o.filter})}function s(l={}){ft(()=>{g("request",{pagination:l.pagination||f.value,filter:l.filter||o.filter,getCellValue:a})})}function m(l,c){const u=it({...f.value,...l});if(pl(f.value,u)===!0){n.value===!0&&c===!0&&d(u);return}if(n.value===!0){d(u);return}o.pagination!==void 0&&o["onUpdate:pagination"]!==void 0?g("update:pagination",u):r.value=u}return{innerPagination:r,computedPagination:f,isServerSide:n,requestServerInteraction:s,setPagination:m}}function Rl(e,a,o,g,r,f){const{props:n,emit:d,proxy:{$q:s}}=e,m=b(()=>g.value===!0?o.value.rowsNumber||0:f.value),l=b(()=>{const{page:B,rowsPerPage:F}=o.value;return(B-1)*F}),c=b(()=>{const{page:B,rowsPerPage:F}=o.value;return B*F}),u=b(()=>o.value.page===1),y=b(()=>o.value.rowsPerPage===0?1:Math.max(1,Math.ceil(m.value/o.value.rowsPerPage))),p=b(()=>c.value===0?!0:o.value.page>=y.value),q=b(()=>(n.rowsPerPageOptions.includes(a.value.rowsPerPage)?n.rowsPerPageOptions:[a.value.rowsPerPage].concat(n.rowsPerPageOptions)).map(F=>({label:F===0?s.lang.table.allRows:""+F,value:F})));M(y,(B,F)=>{if(B===F)return;const re=o.value.page;B&&!re?r({page:1}):B<re&&r({page:B})});function h(){r({page:1})}function D(){const{page:B}=o.value;B>1&&r({page:B-1})}function A(){const{page:B,rowsPerPage:F}=o.value;c.value>0&&B*F<m.value&&r({page:B+1})}function V(){r({page:y.value})}return n["onUpdate:pagination"]!==void 0&&d("update:pagination",{...o.value}),{firstRowIndex:l,lastRowIndex:c,isFirstPage:u,isLastPage:p,pagesNumber:y,computedRowsPerPageOptions:q,computedRowsNumber:m,firstPage:h,prevPage:D,nextPage:A,lastPage:V}}const Bl={selection:{type:String,default:"none",validator:e=>["single","multiple","none"].includes(e)},selected:{type:Array,default:()=>[]}},Ol=["update:selected","selection"];function Fl(e,a,o,g){const r=b(()=>{const p={};return e.selected.map(g.value).forEach(q=>{p[q]=!0}),p}),f=b(()=>e.selection!=="none"),n=b(()=>e.selection==="single"),d=b(()=>e.selection==="multiple"),s=b(()=>o.value.length!==0&&o.value.every(p=>r.value[g.value(p)]===!0)),m=b(()=>s.value!==!0&&o.value.some(p=>r.value[g.value(p)]===!0)),l=b(()=>e.selected.length);function c(p){return r.value[p]===!0}function u(){a("update:selected",[])}function y(p,q,h,D){a("selection",{rows:q,added:h,keys:p,evt:D});const A=n.value===!0?h===!0?q:[]:h===!0?e.selected.concat(q):e.selected.filter(V=>p.includes(g.value(V))===!1);a("update:selected",A)}return{hasSelectionMode:f,singleSelection:n,multipleSelection:d,allRowsSelected:s,someRowsSelected:m,rowsSelectedNumber:l,isRowSelected:c,clearSelection:u,updateSelection:y}}function ut(e){return Array.isArray(e)?e.slice():[]}const $l={expanded:Array},Dl=["update:expanded"];function Al(e,a){const o=L(ut(e.expanded));M(()=>e.expanded,n=>{o.value=ut(n)});function g(n){return o.value.includes(n)}function r(n){e.expanded!==void 0?a("update:expanded",n):o.value=n}function f(n,d){const s=o.value.slice(),m=s.indexOf(n);d===!0?m===-1&&(s.push(n),r(s)):m!==-1&&(s.splice(m,1),r(s))}return{isRowExpanded:g,setExpanded:r,updateExpanded:f}}const El={visibleColumns:Array};function Ll(e,a,o){const g=b(()=>{if(e.columns!==void 0)return e.columns;const d=e.rows[0];return d!==void 0?Object.keys(d).map(s=>({name:s,label:s.toUpperCase(),field:s,align:Le(d[s])?"right":"left",sortable:!0})):[]}),r=b(()=>{const{sortBy:d,descending:s}=a.value;return(e.visibleColumns!==void 0?g.value.filter(l=>l.required===!0||e.visibleColumns.includes(l.name)===!0):g.value).map(l=>{const c=l.align||"right",u=`text-${c}`;return{...l,align:c,__iconClass:`q-table__sort-icon q-table__sort-icon--${c}`,__thClass:u+(l.headerClasses!==void 0?" "+l.headerClasses:"")+(l.sortable===!0?" sortable":"")+(l.name===d?` sorted ${s===!0?"sort-desc":""}`:""),__tdStyle:l.style!==void 0?typeof l.style!="function"?()=>l.style:l.style:()=>null,__tdClass:l.classes!==void 0?typeof l.classes!="function"?()=>u+" "+l.classes:y=>u+" "+l.classes(y):()=>u}})}),f=b(()=>{const d={};return r.value.forEach(s=>{d[s.name]=s}),d}),n=b(()=>e.tableColspan!==void 0?e.tableColspan:r.value.length+(o.value===!0?1:0));return{colList:g,computedCols:r,computedColsMap:f,computedColspan:n}}const ye="q-table__bottom row items-center",_t={};bt.forEach(e=>{_t[e]={}});var Vl=G({name:"QTable",props:{rows:{type:Array,default:()=>[]},rowKey:{type:[String,Function],default:"id"},columns:Array,loading:Boolean,iconFirstPage:String,iconPrevPage:String,iconNextPage:String,iconLastPage:String,title:String,hideHeader:Boolean,grid:Boolean,gridHeader:Boolean,dense:Boolean,flat:Boolean,bordered:Boolean,square:Boolean,separator:{type:String,default:"horizontal",validator:e=>["horizontal","vertical","cell","none"].includes(e)},wrapCells:Boolean,virtualScroll:Boolean,virtualScrollTarget:{default:void 0},..._t,noDataLabel:String,noResultsLabel:String,loadingLabel:String,selectedRowsLabel:Function,rowsPerPageLabel:String,paginationLabel:Function,color:{type:String,default:"grey-8"},titleClass:[String,Array,Object],tableStyle:[String,Array,Object],tableClass:[String,Array,Object],tableHeaderStyle:[String,Array,Object],tableHeaderClass:[String,Array,Object],cardContainerClass:[String,Array,Object],cardContainerStyle:[String,Array,Object],cardStyle:[String,Array,Object],cardClass:[String,Array,Object],hideBottom:Boolean,hideSelectedBanner:Boolean,hideNoData:Boolean,hidePagination:Boolean,onRowClick:Function,onRowDblclick:Function,onRowContextmenu:Function,...Me,...yl,...El,...Cl,...xl,...$l,...Bl,...kl},emits:["request","virtualScroll",...wl,...Dl,...Ol],setup(e,{slots:a,emit:o}){const g=ee(),{proxy:{$q:r}}=g,f=je(e,r),{inFullscreen:n,toggleFullscreen:d}=Sl(),s=b(()=>typeof e.rowKey=="function"?e.rowKey:t=>t[e.rowKey]),m=L(null),l=L(null),c=b(()=>e.grid!==!0&&e.virtualScroll===!0),u=b(()=>" q-table__card"+(f.value===!0?" q-table__card--dark q-dark":"")+(e.square===!0?" q-table--square":"")+(e.flat===!0?" q-table--flat":"")+(e.bordered===!0?" q-table--bordered":"")),y=b(()=>`q-table__container q-table--${e.separator}-separator column no-wrap`+(e.grid===!0?" q-table--grid":u.value)+(f.value===!0?" q-table--dark":"")+(e.dense===!0?" q-table--dense":"")+(e.wrapCells===!1?" q-table--no-wrap":"")+(n.value===!0?" fullscreen scroll":"")),p=b(()=>y.value+(e.loading===!0?" q-table--loading":""));M(()=>e.tableStyle+e.tableClass+e.tableHeaderStyle+e.tableHeaderClass+y.value,()=>{c.value===!0&&l.value!==null&&l.value.reset()});const{innerPagination:q,computedPagination:h,isServerSide:D,requestServerInteraction:A,setPagination:V}=Tl(g,Y),{computedFilterMethod:B}=Pl(e,V),{isRowExpanded:F,setExpanded:re,updateExpanded:yt}=Al(e,o),we=b(()=>{let t=e.rows;if(D.value===!0||t.length===0)return t;const{sortBy:v,descending:_}=h.value;return e.filter&&(t=B.value(t,e.filter,j.value,Y)),qt.value!==null&&(t=Ct.value(e.rows===t?t.slice():t,v,_)),t}),ze=b(()=>we.value.length),I=b(()=>{let t=we.value;if(D.value===!0)return t;const{rowsPerPage:v}=h.value;return v!==0&&(ie.value===0&&e.rows!==t?t.length>ue.value&&(t=t.slice(0,ue.value)):t=t.slice(ie.value,ue.value)),t}),{hasSelectionMode:X,singleSelection:wt,multipleSelection:Qe,allRowsSelected:St,someRowsSelected:Ke,rowsSelectedNumber:Se,isRowSelected:he,clearSelection:ht,updateSelection:se}=Fl(e,o,I,s),{colList:kt,computedCols:j,computedColsMap:Ie,computedColspan:He}=Ll(e,h,X),{columnToSort:qt,computedSortMethod:Ct,sort:ke}=ql(e,h,kt,V),{firstRowIndex:ie,lastRowIndex:ue,isFirstPage:qe,isLastPage:Ce,pagesNumber:ce,computedRowsPerPageOptions:Pt,computedRowsNumber:de,firstPage:Pe,prevPage:pe,nextPage:xe,lastPage:Te}=Rl(g,q,h,D,V,ze),pt=b(()=>I.value.length===0),xt=b(()=>{const t={};return bt.forEach(v=>{t[v]=e[v]}),t.virtualScrollItemSize===void 0&&(t.virtualScrollItemSize=e.dense===!0?28:48),t});function Tt(){c.value===!0&&l.value.reset()}function Rt(){if(e.grid===!0)return jt();const t=e.hideHeader!==!0?Ye:null;if(c.value===!0){const _=a["top-row"],w=a["bottom-row"],k={default:T=>We(T.item,a.body,T.index)};if(_!==void 0){const T=i("tbody",_({cols:j.value}));k.before=t===null?()=>T:()=>[t()].concat(T)}else t!==null&&(k.before=t);return w!==void 0&&(k.after=()=>i("tbody",w({cols:j.value}))),i(bl,{ref:l,class:e.tableClass,style:e.tableStyle,...xt.value,scrollTarget:e.virtualScrollTarget,items:I.value,type:"__qtable",tableColspan:He.value,onVirtualScroll:Ot},k)}const v=[Ft()];return t!==null&&v.unshift(t()),mt({class:["q-table__middle scroll",e.tableClass],style:e.tableStyle},v)}function Bt(t,v){if(l.value!==null){l.value.scrollTo(t,v);return}t=parseInt(t,10);const _=m.value.querySelector(`tbody tr:nth-of-type(${t+1})`);if(_!==null){const w=m.value.querySelector(".q-table__middle.scroll"),k=_.offsetTop-e.virtualScrollStickySizeStart,T=k<w.scrollTop?"decrease":"increase";w.scrollTop=k,o("virtualScroll",{index:t,from:0,to:q.value.rowsPerPage-1,direction:T})}}function Ot(t){o("virtualScroll",t)}function Ue(){return[i(_l,{class:"q-table__linear-progress",color:e.color,dark:f.value,indeterminate:!0,trackColor:"transparent"})]}function We(t,v,_){const w=s.value(t),k=he(w);if(v!==void 0)return v(Ge({key:w,row:t,pageIndex:_,__trClass:k?"selected":""}));const T=a["body-cell"],x=j.value.map($=>{const fe=a[`body-cell-${$.name}`],ge=fe!==void 0?fe:T;return ge!==void 0?ge($t({key:w,row:t,pageIndex:_,col:$})):i("td",{class:$.__tdClass(t),style:$.__tdStyle(t)},Y($,t))});if(X.value===!0){const $=a["body-selection"],fe=$!==void 0?$(Dt({key:w,row:t,pageIndex:_})):[i(Ae,{modelValue:k,color:e.color,dark:f.value,dense:e.dense,"onUpdate:modelValue":(ge,zt)=>{se([w],[t],ge,zt)}})];x.unshift(i("td",{class:"q-table--col-auto-width"},fe))}const z={key:w,class:{selected:k}};return e.onRowClick!==void 0&&(z.class["cursor-pointer"]=!0,z.onClick=$=>{o("RowClick",$,t,_)}),e.onRowDblclick!==void 0&&(z.class["cursor-pointer"]=!0,z.onDblclick=$=>{o("RowDblclick",$,t,_)}),e.onRowContextmenu!==void 0&&(z.class["cursor-pointer"]=!0,z.onContextmenu=$=>{o("RowContextmenu",$,t,_)}),i("tr",z,x)}function Ft(){const t=a.body,v=a["top-row"],_=a["bottom-row"];let w=I.value.map((k,T)=>We(k,t,T));return v!==void 0&&(w=v({cols:j.value}).concat(w)),_!==void 0&&(w=w.concat(_({cols:j.value}))),i("tbody",w)}function Ge(t){return Re(t),t.cols=t.cols.map(v=>te({...v},"value",()=>Y(v,t.row))),t}function $t(t){return Re(t),te(t,"value",()=>Y(t.col,t.row)),t}function Dt(t){return Re(t),t}function Re(t){Object.assign(t,{cols:j.value,colsMap:Ie.value,sort:ke,rowIndex:ie.value+t.pageIndex,color:e.color,dark:f.value,dense:e.dense}),X.value===!0&&te(t,"selected",()=>he(t.key),(v,_)=>{se([t.key],[t.row],v,_)}),te(t,"expand",()=>F(t.key),v=>{yt(t.key,v)})}function Y(t,v){const _=typeof t.field=="function"?t.field(v):v[t.field];return t.format!==void 0?t.format(_,v):_}const Z=b(()=>({pagination:h.value,pagesNumber:ce.value,isFirstPage:qe.value,isLastPage:Ce.value,firstPage:Pe,prevPage:pe,nextPage:xe,lastPage:Te,inFullscreen:n.value,toggleFullscreen:d}));function At(){const t=a.top,v=a["top-left"],_=a["top-right"],w=a["top-selection"],k=X.value===!0&&w!==void 0&&Se.value>0,T="q-table__top relative-position row items-center";if(t!==void 0)return i("div",{class:T},[t(Z.value)]);let x;if(k===!0?x=w(Z.value).slice():(x=[],v!==void 0?x.push(i("div",{class:"q-table__control"},[v(Z.value)])):e.title&&x.push(i("div",{class:"q-table__control"},[i("div",{class:["q-table__title",e.titleClass]},e.title)]))),_!==void 0&&(x.push(i("div",{class:"q-table__separator col"})),x.push(i("div",{class:"q-table__control"},[_(Z.value)]))),x.length!==0)return i("div",{class:T},x)}const Xe=b(()=>Ke.value===!0?null:St.value);function Ye(){const t=Et();return e.loading===!0&&a.loading===void 0&&t.push(i("tr",{class:"q-table__progress"},[i("th",{class:"relative-position",colspan:He.value},Ue())])),i("thead",t)}function Et(){const t=a.header,v=a["header-cell"];if(t!==void 0)return t(Be({header:!0})).slice();const _=j.value.map(w=>{const k=a[`header-cell-${w.name}`],T=k!==void 0?k:v,x=Be({col:w});return T!==void 0?T(x):i(cl,{key:w.name,props:x},()=>w.label)});if(wt.value===!0&&e.grid!==!0)_.unshift(i("th",{class:"q-table--col-auto-width"}," "));else if(Qe.value===!0){const w=a["header-selection"],k=w!==void 0?w(Be({})):[i(Ae,{color:e.color,modelValue:Xe.value,dark:f.value,dense:e.dense,"onUpdate:modelValue":Ze})];_.unshift(i("th",{class:"q-table--col-auto-width"},k))}return[i("tr",{class:e.tableHeaderClass,style:e.tableHeaderStyle},_)]}function Be(t){return Object.assign(t,{cols:j.value,sort:ke,colsMap:Ie.value,color:e.color,dark:f.value,dense:e.dense}),Qe.value===!0&&te(t,"selected",()=>Xe.value,Ze),t}function Ze(t){Ke.value===!0&&(t=!1),se(I.value.map(s.value),I.value,t)}const ve=b(()=>{const t=[e.iconFirstPage||r.iconSet.table.firstPage,e.iconPrevPage||r.iconSet.table.prevPage,e.iconNextPage||r.iconSet.table.nextPage,e.iconLastPage||r.iconSet.table.lastPage];return r.lang.rtl===!0?t.reverse():t});function Lt(){if(e.hideBottom===!0)return;if(pt.value===!0){if(e.hideNoData===!0)return;const _=e.loading===!0?e.loadingLabel||r.lang.table.loading:e.filter?e.noResultsLabel||r.lang.table.noResults:e.noDataLabel||r.lang.table.noData,w=a["no-data"],k=w!==void 0?[w({message:_,icon:r.iconSet.table.warning,filter:e.filter})]:[i(ne,{class:"q-table__bottom-nodata-icon",name:r.iconSet.table.warning}),_];return i("div",{class:ye+" q-table__bottom--nodata"},k)}const t=a.bottom;if(t!==void 0)return i("div",{class:ye},[t(Z.value)]);const v=e.hideSelectedBanner!==!0&&X.value===!0&&Se.value>0?[i("div",{class:"q-table__control"},[i("div",[(e.selectedRowsLabel||r.lang.table.selectedRecords)(Se.value)])])]:[];if(e.hidePagination!==!0)return i("div",{class:ye+" justify-end"},Nt(v));if(v.length!==0)return i("div",{class:ye},v)}function Vt(t){V({page:1,rowsPerPage:t.value})}function Nt(t){let v;const{rowsPerPage:_}=h.value,w=e.paginationLabel||r.lang.table.pagination,k=a.pagination,T=e.rowsPerPageOptions.length>1;if(t.push(i("div",{class:"q-table__separator col"})),T===!0&&t.push(i("div",{class:"q-table__control"},[i("span",{class:"q-table__bottom-item"},[e.rowsPerPageLabel||r.lang.table.recordsPerPage]),i(ul,{class:"q-table__select inline q-table__bottom-item",color:e.color,modelValue:_,options:Pt.value,displayValue:_===0?r.lang.table.allRows:_,dark:f.value,borderless:!0,dense:!0,optionsDense:!0,optionsCover:!0,"onUpdate:modelValue":Vt})])),k!==void 0)v=k(Z.value);else if(v=[i("span",_!==0?{class:"q-table__bottom-item"}:{},[_?w(ie.value+1,Math.min(ue.value,de.value),de.value):w(1,ze.value,de.value)])],_!==0&&ce.value>1){const x={color:e.color,round:!0,dense:!0,flat:!0};e.dense===!0&&(x.size="sm"),ce.value>2&&v.push(i(H,{key:"pgFirst",...x,icon:ve.value[0],disable:qe.value,onClick:Pe})),v.push(i(H,{key:"pgPrev",...x,icon:ve.value[1],disable:qe.value,onClick:pe}),i(H,{key:"pgNext",...x,icon:ve.value[2],disable:Ce.value,onClick:xe})),ce.value>2&&v.push(i(H,{key:"pgLast",...x,icon:ve.value[3],disable:Ce.value,onClick:Te}))}return t.push(i("div",{class:"q-table__control"},v)),t}function Mt(){const t=e.gridHeader===!0?[i("table",{class:"q-table"},[Ye()])]:e.loading===!0&&a.loading===void 0?Ue():void 0;return i("div",{class:"q-table__middle"},t)}function jt(){const t=a.item!==void 0?a.item:v=>{const _=v.cols.map(k=>i("div",{class:"q-table__grid-item-row"},[i("div",{class:"q-table__grid-item-title"},[k.label]),i("div",{class:"q-table__grid-item-value"},[k.value])]));if(X.value===!0){const k=a["body-selection"],T=k!==void 0?k(v):[i(Ae,{modelValue:v.selected,color:e.color,dark:f.value,dense:e.dense,"onUpdate:modelValue":(x,z)=>{se([v.key],[v.row],x,z)}})];_.unshift(i("div",{class:"q-table__grid-item-row"},T),i(oe,{dark:f.value}))}const w={class:["q-table__grid-item-card"+u.value,e.cardClass],style:e.cardStyle};return(e.onRowClick!==void 0||e.onRowDblclick!==void 0)&&(w.class[0]+=" cursor-pointer",e.onRowClick!==void 0&&(w.onClick=k=>{o("RowClick",k,v.row,v.pageIndex)}),e.onRowDblclick!==void 0&&(w.onDblclick=k=>{o("RowDblclick",k,v.row,v.pageIndex)})),i("div",{class:"q-table__grid-item col-xs-12 col-sm-6 col-md-4 col-lg-3"+(v.selected===!0?" q-table__grid-item--selected":"")},[i("div",w,_)])};return i("div",{class:["q-table__grid-content row",e.cardContainerClass],style:e.cardContainerStyle},I.value.map((v,_)=>t(Ge({key:s.value(v),row:v,pageIndex:_}))))}return Object.assign(g.proxy,{requestServerInteraction:A,setPagination:V,firstPage:Pe,prevPage:pe,nextPage:xe,lastPage:Te,isRowSelected:he,clearSelection:ht,isRowExpanded:F,setExpanded:re,sort:ke,resetVirtualScroll:Tt,scrollTo:Bt,getCellValue:Y}),Jt(g.proxy,{filteredSortedRows:()=>we.value,computedRows:()=>I.value,computedRowsNumber:()=>de.value}),()=>{const t=[At()],v={ref:m,class:p.value};return e.grid===!0?t.push(Mt()):Object.assign(v,{class:[v.class,e.cardClass],style:e.cardStyle}),t.push(Rt(),Lt()),e.loading===!0&&a.loading!==void 0&&t.push(a.loading()),i("div",v,t)}}});const Nl=gt({__name:"CancelEscrowButton",props:["escrow_address","label"],setup(e){const a=e,o=Ve();async function g(){const{pg_escrow:r}=tl();let f;f=o.notify({group:!1,timeout:0,spinner:!0,message:"Sending TX..."});try{const n=await r.value.account.escrow.fetch(a.escrow_address),d=n.seed,s=Q.findProgramAddressSync([me.Buffer.from("escrow"),N().publicKey.value.toBytes(),d.toArrayLike(me.Buffer).reverse()],r.value.programId)[0],m=Q.findProgramAddressSync([me.Buffer.from("vault"),s.toBuffer()],r.value.programId)[0],l=Q.findProgramAddressSync([me.Buffer.from("auth"),s.toBuffer()],r.value.programId)[0],c=Je(new Q(n.depositToken),N().publicKey.value,void 0,Fe,$e);await et(new Q(n.depositToken),N().publicKey.value)||await tt(c,new Q(n.depositToken));const u=Je(new Q(n.requestToken),N().publicKey.value,void 0,Fe,$e);await et(new Q(n.requestToken),N().publicKey.value)||await tt(u,new Q(n.requestToken));let y=await r.value.methods.cancel().accounts({maker:N().publicKey.value,makerAta:c,depositToken:n.depositToken,makerAtaRequest:u,makerTokenRequest:n.requestToken,auth:l,escrow:s,vault:m,tokenProgram:Fe,associatedTokenProgram:$e,systemProgram:el.programId});y=await y.rpc(),console.log(`TX_Signature = ${y}`),await Qt(C().connection,y),f({type:"positive",icon:"done",spinner:!1,message:"Transaction confirmed!",timeout:2500})}catch(n){f({type:"negative",icon:"error",spinner:!1,message:n.toString(),timeout:5e3}),console.error(n)}}return(r,f)=>(U(),W(H,{icon:"close",class:"col",color:"primary",label:e.label,onClick:f[0]||(f[0]=n=>{g().then(()=>{console.info("build_tx executed")})})},null,8,["label"]))}});const Ml={class:"row items-center"},jl={class:"col"},zl={class:"col"},Ql={class:"col text-bold text-subtitle2"},Kl={class:"row items-center"},Il={class:"col"},Hl={class:"col"},Ul={class:"col text-bold text-subtitle2"},Wl={class:"col"},Gl={class:"row items-center"},Xl={class:"col text-right text-subtitle1"},Yl={class:"row items-center"},Zl={class:"col text-right text-subtitle1"},Jl={class:"col"},ea={class:"row q-gutter-x-sm items-center"},ta={class:"col text-subtitle1 text-weight-bold text-right"},la={class:"col-1"},aa={class:"row q-gutter-x-sm items-center"},oa={class:"col text-subtitle1 text-weight-bold text-right"},na={class:"col-1"},va=gt({__name:"EscrowTable",props:["title","escrow_filter","show_close_button"],setup(e){const a=e,o=L(!1);Ve(),b(()=>{var m,l,c;let s=C().escrows;switch(a.escrow_filter){case"p2p":s=(m=C().escrows)==null?void 0:m.filter(u=>{var y,p;return u.account.recipient.toString()!=rt.toString()&&(u.account.maker.toString()==((y=N().publicKey.value)==null?void 0:y.toString())||u.account.recipient.toString()==((p=N().publicKey.value)==null?void 0:p.toString()))});break;case"b2b":s=(l=C().escrows)==null?void 0:l.filter(u=>u.account.onlyWhitelist==!0);break;default:s=(c=C().escrows)==null?void 0:c.filter(u=>u.account.recipient.toString()==rt.toString()&&u.account.onlyWhitelist!=!0&&u.account.tokensDepositRemaining.toNumber()>0);break}return d.value&&(n.value.some(u=>u=="buying")&&(console.log(d.value.mint.toString()),s=s==null?void 0:s.filter(u=>u.account.depositToken.toString()==d.value.mint.toString())),n.value.some(u=>u=="selling")&&(console.log(d.value.mint.toString()),s=s==null?void 0:s.filter(u=>u.account.requestToken.toString()===d.value.mint.toString()))),s}),M(()=>C().is_initialized,async()=>{await C().load_all_escrows()}),Ne(async()=>{C().is_initialized&&await C().load_all_escrows()});function g(s){var m;a.show_close_button?(C().escrow_selected=s,o.value=!o.value):s.publicKey!=((m=C().escrow_selected)==null?void 0:m.publicKey)?(C().escrow_selected=s,C().showRightDrawer=!0):C().showRightDrawer=!C().showRightDrawer}const r=L({rowsPerPage:0}),f=L([{name:"icons",label:"Tokens",align:"center",style:"200px"},{name:"amounts",label:"Size",align:"right"},{name:"price",label:"Price per Unit",align:"right"},{name:"space",label:""},{name:"balance",label:"",style:"width:10px"},{name:"expire",label:"",style:"width:10px"},{name:"creator",label:"",style:"width:10px"},{name:"state",label:"",style:"width:10px"},{name:"take",label:"",style:"width:10px"}]);L([{label:"Buying",value:"buying"},{label:"Selling",value:"selling"}]);const n=L([]),d=L();return(s,m)=>(U(),W(Vl,{flat:"",title:a.title,rows:O(C)().escrows_filtered,columns:f.value,"row-key":"name",filter:s.filter,pagination:r.value,"onUpdate:pagination":m[0]||(m[0]=l=>r.value=l),"rows-per-page-options":[0]},{top:P(()=>[]),body:P(l=>[S(Ee,{class:ll(l.rowIndex%2?"":"bg-secondary"),props:l,onClick:c=>g(l.row)},{default:P(()=>[S(E,{key:"icons",props:l},{default:P(()=>{var c;return[R("div",Ml,[R("div",jl,[S(lt,{outline:"",label:"TAKES",color:"red",rounded:""})]),R("div",zl,[S(_e,{size:"lg",color:"white"},{default:P(()=>{var u;return[S(be,{src:((u=O(C)().token_list.find(y=>y.address==l.row.account.requestToken.toString()))==null?void 0:u.logoURI)??"unknown.png"},null,8,["src"])]}),_:2},1024)]),R("p",Ql,K(O(C)().token_list.find(u=>u.address==l.row.account.requestToken.toString()).symbol),1)]),S(oe,{class:"q-my-sm",color:""}),R("div",Kl,[R("div",Il,[S(lt,{outline:"",label:"GIVES",color:"green",rounded:""})]),R("div",Hl,[S(_e,{size:"lg",color:"white"},{default:P(()=>{var u;return[S(be,{src:((u=O(C)().token_list.find(y=>y.address==l.row.account.depositToken.toString()))==null?void 0:u.logoURI)??"unknown.png"},null,8,["src"])]}),_:2},1024)]),R("div",Ul,K((c=O(C)().token_list.find(u=>u.address==l.row.account.depositToken.toString()))==null?void 0:c.symbol),1)])]}),_:2},1032,["props"]),S(E,{key:"amounts",props:l},{default:P(()=>{var c,u;return[R("div",Wl,[R("div",Gl,[R("div",Xl,K((l.row.account.tokensDepositRemaining*10**-((c=O(C)().token_list.find(y=>y.address==l.row.account.depositToken.toString()))==null?void 0:c.decimals)*l.row.account.price).toFixed(3)),1)]),S(oe,{class:"q-my-sm"}),R("div",Yl,[R("div",Zl,K((l.row.account.tokensDepositRemaining*Math.pow(10,-((u=O(C)().token_list.find(y=>y.address==l.row.account.depositToken.toString()))==null?void 0:u.decimals))).toFixed(3)),1)])])]}),_:2},1032,["props"]),S(E,{key:"price",props:l,class:"col q-gutter-x-sm"},{default:P(()=>[R("div",Jl,[R("div",ea,[R("div",ta,K(l.row.account.price.toFixed(8)),1),R("div",la,[S(_e,{size:"xs",color:"white"},{default:P(()=>{var c;return[S(be,{src:((c=O(C)().token_list.find(u=>u.address==l.row.account.requestToken.toString()))==null?void 0:c.logoURI)??"unknown.png"},null,8,["src"])]}),_:2},1024)])]),S(oe,{class:"q-my-sm"}),R("div",aa,[R("div",oa,K((1/l.row.account.price).toFixed(8)),1),R("div",na,[S(_e,{size:"xs",color:"white"},{default:P(()=>{var c;return[S(be,{src:((c=O(C)().token_list.find(u=>u.address==l.row.account.depositToken.toString()))==null?void 0:c.logoURI)??"unknown.png"},null,8,["src"])]}),_:2},1024)])])])]),_:2},1032,["props"]),S(E,{key:"space",props:l},null,8,["props"]),S(E,{key:"balance",props:l},{default:P(()=>[S(ne,{size:"sm",name:"balance",color:l.row.account.allowPartialFill?"purple":"grey"},{default:P(()=>[S(Oe,null,{default:P(()=>[De("Partial fill "+K(l.row.account.allowPartialFill?"":"NOT ")+" allowed",1)]),_:2},1024)]),_:2},1032,["color"])]),_:2},1032,["props"]),S(E,{key:"expire",props:l},{default:P(()=>[S(ne,{size:"sm",name:"timer",color:l.row.account.expireTimestamp>0?"orange":"grey"},{default:P(()=>[S(Oe,null,{default:P(()=>[De("Will "+K(l.row.account.expireTimestamp>0?"":"NOT ")+" expire",1)]),_:2},1024)]),_:2},1032,["color"])]),_:2},1032,["props"]),S(E,{key:"creator",props:l},{default:P(()=>{var c;return[S(ne,{size:"sm",name:"design_services",color:l.row.account.maker.toString()==((c=O(N)().publicKey.value)==null?void 0:c.toString())?"orange":"grey"},{default:P(()=>[S(Oe,null,{default:P(()=>{var u;return[De("You are "+K(l.row.account.maker.toString()==((u=O(N)().publicKey.value)==null?void 0:u.toString())?"":"NOT ")+" the creator",1)]}),_:2},1024)]),_:2},1032,["color"])]}),_:2},1032,["props"]),S(E,{key:"state",props:l},{default:P(()=>[S(Kt,{size:"sm",escrow:l.row},null,8,["escrow"])]),_:2},1032,["props"]),e.show_close_button?le("",!0):(U(),W(E,{key:"take",props:l},{default:P(()=>[S(H,{color:"primary",icon:"send"})]),_:2},1032,["props"])),e.show_close_button?(U(),W(E,{key:"take",props:l},{default:P(()=>[S(H,{color:"primary",icon:"info"})]),_:2},1032,["props"])):le("",!0)]),_:2},1032,["class","props","onClick"]),o.value&&l.row.publicKey==O(C)().escrow_selected.publicKey.toString()?(U(),W(Ee,{key:0,props:l},{default:P(()=>[S(E,{colspan:"100%"},{default:P(()=>[S(nl,{class:"bg-dark",align:"justify"},{default:P(()=>{var c;return[S(H,{class:"col",color:"primary",label:"Expand offer",name:"tab_expand",icon:"open_in_full",to:"view/"+((c=O(C)().escrow_selected)==null?void 0:c.publicKey)},null,8,["to"]),S(oe,{vertical:""}),S(Nl,{escrow_address:l.row.publicKey,label:`${l.row.account.tokensDepositRemaining>0?"Cancel Offer":"Close Accounts"} (+${O(al)}sol)`},null,8,["escrow_address","label"])]}),_:2},1024)]),_:2},1024)]),_:2},1032,["props"])):le("",!0),O(Ve)().screen.lt.md&&O(C)().showRightDrawer&&l.row.publicKey==O(C)().escrow_selected.publicKey.toString()?(U(),W(Ee,{key:1,"no-hover":"",props:l},{default:P(()=>[e.show_close_button?le("",!0):(U(),W(E,{key:0,colspan:"100%",class:"bg-dark q-ma-none q-pa-none"},{default:P(()=>[S(rl)]),_:1}))]),_:2},1032,["props"])):le("",!0)]),_:1},8,["title","rows","columns","filter","pagination"]))}});export{va as _};
