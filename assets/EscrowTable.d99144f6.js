import{g as Ye,w as jt,b as Je,c as xe,d as Qt}from"./EscrowTakeView.e9781110.js";import{t as W,u as b,v as s,w as J,F as Z,E as zt,ag as oe,A as E,C as V,bl as st,G as Le,au as Ht,at as Kt,D as ut,Q as It,R as Ze,N as ct,ay as Ut,az as Wt,b9 as Gt,bi as et,a$ as De,bn as tt,b0 as Xt,H as dt,bo as Yt,a_ as ee,a7 as H,a9 as vt,aG as Ae,a2 as I,a3 as U,b6 as Jt,P as te,aJ as ge,aE as K,aO as Re,aP as Be,b4 as Zt,ah as p,a4 as C,ac as B,aF as lt,a5 as q,a8 as N,aj as z,ae as at,a6 as Oe,ai as le,bp as el}from"./index.67613471.js";import{a as Ee}from"./QCardSection.bd02770a.js";import{g as tl,a as Fe,b as ot,c as ll,e as al}from"./FilterEscrows.75e1c52e.js";import{u as Ne,a as Ve}from"./QCard.4f11f3b6.js";import{f as ol,g as nl,h as ft,e as rl}from"./QSelect.dd8d043b.js";var A=W({name:"QTd",props:{props:Object,autoWidth:Boolean,noHover:Boolean},setup(e,{slots:a}){const o=Z(),g=b(()=>"q-td"+(e.autoWidth===!0?" q-table--col-auto-width":"")+(e.noHover===!0?" q-td--no-hover":"")+" ");return()=>{if(e.props===void 0)return s("td",{class:g.value},J(a.default));const n=o.vnode.key,f=(e.props.colsMap!==void 0?e.props.colsMap[n]:null)||e.props.col;if(f===void 0)return;const{row:r}=e.props;return s("td",{class:g.value+f.__tdClass(r),style:f.__tdStyle(r)},J(a.default))}}}),$e=W({name:"QTr",props:{props:Object,noHover:Boolean},setup(e,{slots:a}){const o=b(()=>"q-tr"+(e.props===void 0||e.props.header===!0?"":" "+e.props.__trClass)+(e.noHover===!0?" q-tr--no-hover":""));return()=>s("tr",{class:o.value},J(a.default))}}),il=W({name:"QTh",props:{props:Object,autoWidth:Boolean},emits:["click"],setup(e,{slots:a,emit:o}){const g=Z(),{proxy:{$q:n}}=g,f=r=>{o("click",r)};return()=>{if(e.props===void 0)return s("th",{class:e.autoWidth===!0?"q-table--col-auto-width":"",onClick:f},J(a.default));let r,u;const i=g.vnode.key;if(i){if(r=e.props.colsMap[i],r===void 0)return}else r=e.props.col;if(r.sortable===!0){const l=r.align==="right"?"unshift":"push";u=zt(a.default,[]),u[l](s(oe,{class:r.__iconClass,name:n.iconSet.table.arrowUp}))}else u=J(a.default);const m={class:r.__thClass+(e.autoWidth===!0?" q-table--col-auto-width":""),style:r.headerStyle,onClick:l=>{r.sortable===!0&&e.props.sort(r),f(l)}};return s("th",m,u)}}});const sl=["horizontal","vertical","cell","none"];var ul=W({name:"QMarkupTable",props:{...Ne,dense:Boolean,flat:Boolean,bordered:Boolean,square:Boolean,wrapCells:Boolean,separator:{type:String,default:"horizontal",validator:e=>sl.includes(e)}},setup(e,{slots:a}){const o=Z(),g=Ve(e,o.proxy.$q),n=b(()=>`q-markup-table q-table__container q-table__card q-table--${e.separator}-separator`+(g.value===!0?" q-table--dark q-table__card--dark q-dark":"")+(e.dense===!0?" q-table--dense":"")+(e.flat===!0?" q-table--flat":"")+(e.bordered===!0?" q-table--bordered":"")+(e.square===!0?" q-table--square":"")+(e.wrapCells===!1?" q-table--no-wrap":""));return()=>s("div",{class:n.value},[s("table",{class:"q-table"},J(a.default))])}});function gt(e,a){return s("div",e,[s("table",{class:"q-table"},a)])}const cl={list:tl,table:ul},dl=["list","table","__qtable"];var vl=W({name:"QVirtualScroll",props:{...ol,type:{type:String,default:"list",validator:e=>dl.includes(e)},items:{type:Array,default:()=>[]},itemsFn:Function,itemsSize:Number,scrollTarget:{default:void 0}},setup(e,{slots:a,attrs:o}){let g;const n=E(null),f=b(()=>e.itemsSize>=0&&e.itemsFn!==void 0?parseInt(e.itemsSize,10):Array.isArray(e.items)?e.items.length:0),{virtualScrollSliceRange:r,localResetVirtualScroll:u,padVirtualScroll:i,onVirtualScrollEvt:m}=nl({virtualScrollLength:f,getVirtualScrollTarget:P,getVirtualScrollEl:y}),l=b(()=>{if(f.value===0)return[];const D=(L,R)=>({index:r.value.from+R,item:L});return e.itemsFn===void 0?e.items.slice(r.value.from,r.value.to).map(D):e.itemsFn(r.value.from,r.value.to-r.value.from).map(D)}),v=b(()=>"q-virtual-scroll q-virtual-scroll"+(e.virtualScrollHorizontal===!0?"--horizontal":"--vertical")+(e.scrollTarget!==void 0?"":" scroll")),c=b(()=>e.scrollTarget!==void 0?{}:{tabindex:0});V(f,()=>{u()}),V(()=>e.scrollTarget,()=>{w(),k()});function y(){return n.value.$el||n.value}function P(){return g}function k(){g=It(y(),e.scrollTarget),g.addEventListener("scroll",m,Ze.passive)}function w(){g!==void 0&&(g.removeEventListener("scroll",m,Ze.passive),g=void 0)}function $(){let D=i(e.type==="list"?"div":"tbody",l.value.map(a.default));return a.before!==void 0&&(D=a.before().concat(D)),ct(a.after,D)}return st(()=>{u()}),Le(()=>{k()}),Ht(()=>{k()}),Kt(()=>{w()}),ut(()=>{w()}),()=>{if(a.default===void 0){console.error("QVirtualScroll: default scoped slot is required for rendering");return}return e.type==="__qtable"?gt({ref:n,class:"q-table__middle "+v.value},$()):s(cl[e.type],{...o,ref:n,class:[o.class,v.value],...c.value},$)}}});const fl={xs:2,sm:4,md:6,lg:10,xl:14};function nt(e,a,o){return{transform:a===!0?`translateX(${o.lang.rtl===!0?"-":""}100%) scale3d(${-e},1,1)`:`scale3d(${e},1,1)`}}var gl=W({name:"QLinearProgress",props:{...Ne,...Ut,value:{type:Number,default:0},buffer:Number,color:String,trackColor:String,reverse:Boolean,stripe:Boolean,indeterminate:Boolean,query:Boolean,rounded:Boolean,animationSpeed:{type:[String,Number],default:2100},instantFeedback:Boolean},setup(e,{slots:a}){const{proxy:o}=Z(),g=Ve(e,o.$q),n=Wt(e,fl),f=b(()=>e.indeterminate===!0||e.query===!0),r=b(()=>e.reverse!==e.query),u=b(()=>({...n.value!==null?n.value:{},"--q-linear-progress-speed":`${e.animationSpeed}ms`})),i=b(()=>"q-linear-progress"+(e.color!==void 0?` text-${e.color}`:"")+(e.reverse===!0||e.query===!0?" q-linear-progress--reverse":"")+(e.rounded===!0?" rounded-borders":"")),m=b(()=>nt(e.buffer!==void 0?e.buffer:1,r.value,o.$q)),l=b(()=>`with${e.instantFeedback===!0?"out":""}-transition`),v=b(()=>`q-linear-progress__track absolute-full q-linear-progress__track--${l.value} q-linear-progress__track--${g.value===!0?"dark":"light"}`+(e.trackColor!==void 0?` bg-${e.trackColor}`:"")),c=b(()=>nt(f.value===!0?1:e.value,r.value,o.$q)),y=b(()=>`q-linear-progress__model absolute-full q-linear-progress__model--${l.value} q-linear-progress__model--${f.value===!0?"in":""}determinate`),P=b(()=>({width:`${e.value*100}%`})),k=b(()=>`q-linear-progress__stripe absolute-${e.reverse===!0?"right":"left"} q-linear-progress__stripe--${l.value}`);return()=>{const w=[s("div",{class:v.value,style:m.value}),s("div",{class:y.value,style:c.value})];return e.stripe===!0&&f.value===!1&&w.push(s("div",{class:k.value,style:P.value})),s("div",{class:i.value,style:u.value,role:"progressbar","aria-valuemin":0,"aria-valuemax":1,"aria-valuenow":e.indeterminate===!0?void 0:e.value},ct(a.default,w))}}});let ae=0;const bl={fullscreen:Boolean,noRouteFullscreenExit:Boolean},ml=["update:fullscreen","fullscreen"];function _l(){const e=Z(),{props:a,emit:o,proxy:g}=e;let n,f,r;const u=E(!1);Gt(e)===!0&&V(()=>g.$route.fullPath,()=>{a.noRouteFullscreenExit!==!0&&l()}),V(()=>a.fullscreen,v=>{u.value!==v&&i()}),V(u,v=>{o("update:fullscreen",v),o("fullscreen",v)});function i(){u.value===!0?l():m()}function m(){u.value!==!0&&(u.value=!0,r=g.$el.parentNode,r.replaceChild(f,g.$el),document.body.appendChild(g.$el),ae++,ae===1&&document.body.classList.add("q-body--fullscreen-mixin"),n={handler:l},et.add(n))}function l(){u.value===!0&&(n!==void 0&&(et.remove(n),n=void 0),r.replaceChild(g.$el,f),u.value=!1,ae=Math.max(0,ae-1),ae===0&&(document.body.classList.remove("q-body--fullscreen-mixin"),g.$el.scrollIntoView!==void 0&&setTimeout(()=>{g.$el.scrollIntoView()})))}return st(()=>{f=document.createElement("span")}),Le(()=>{a.fullscreen===!0&&m()}),ut(l),Object.assign(g,{toggleFullscreen:i,setFullscreen:m,exitFullscreen:l}),{inFullscreen:u,toggleFullscreen:i}}function yl(e,a){return new Date(e)-new Date(a)}const Sl={sortMethod:Function,binaryStateSort:Boolean,columnSortOrder:{type:String,validator:e=>e==="ad"||e==="da",default:"ad"}};function wl(e,a,o,g){const n=b(()=>{const{sortBy:u}=a.value;return u&&o.value.find(i=>i.name===u)||null}),f=b(()=>e.sortMethod!==void 0?e.sortMethod:(u,i,m)=>{const l=o.value.find(y=>y.name===i);if(l===void 0||l.field===void 0)return u;const v=m===!0?-1:1,c=typeof l.field=="function"?y=>l.field(y):y=>y[l.field];return u.sort((y,P)=>{let k=c(y),w=c(P);return l.rawSort!==void 0?l.rawSort(k,w,y,P)*v:k==null?-1*v:w==null?1*v:l.sort!==void 0?l.sort(k,w,y,P)*v:De(k)===!0&&De(w)===!0?(k-w)*v:tt(k)===!0&&tt(w)===!0?yl(k,w)*v:typeof k=="boolean"&&typeof w=="boolean"?(k-w)*v:([k,w]=[k,w].map($=>($+"").toLocaleString().toLowerCase()),k<w?-1*v:k===w?0:v)})});function r(u){let i=e.columnSortOrder;if(Xt(u)===!0)u.sortOrder&&(i=u.sortOrder),u=u.name;else{const v=o.value.find(c=>c.name===u);v!==void 0&&v.sortOrder&&(i=v.sortOrder)}let{sortBy:m,descending:l}=a.value;m!==u?(m=u,l=i==="da"):e.binaryStateSort===!0?l=!l:l===!0?i==="ad"?m=null:l=!1:i==="ad"?l=!0:m=null,g({sortBy:m,descending:l,page:1})}return{columnToSort:n,computedSortMethod:f,sort:r}}const hl={filter:[String,Object],filterMethod:Function};function kl(e,a){const o=b(()=>e.filterMethod!==void 0?e.filterMethod:(g,n,f,r)=>{const u=n?n.toLowerCase():"";return g.filter(i=>f.some(m=>{const l=r(m,i)+"";return(l==="undefined"||l==="null"?"":l.toLowerCase()).indexOf(u)!==-1}))});return V(()=>e.filter,()=>{dt(()=>{a({page:1},!0)})},{deep:!0}),{computedFilterMethod:o}}function ql(e,a){for(const o in a)if(a[o]!==e[o])return!1;return!0}function rt(e){return e.page<1&&(e.page=1),e.rowsPerPage!==void 0&&e.rowsPerPage<1&&(e.rowsPerPage=0),e}const Pl={pagination:Object,rowsPerPageOptions:{type:Array,default:()=>[5,7,10,15,20,25,50,0]},"onUpdate:pagination":[Function,Array]};function Cl(e,a){const{props:o,emit:g}=e,n=E(Object.assign({sortBy:null,descending:!1,page:1,rowsPerPage:o.rowsPerPageOptions.length!==0?o.rowsPerPageOptions[0]:5},o.pagination)),f=b(()=>{const l=o["onUpdate:pagination"]!==void 0?{...n.value,...o.pagination}:n.value;return rt(l)}),r=b(()=>f.value.rowsNumber!==void 0);function u(l){i({pagination:l,filter:o.filter})}function i(l={}){dt(()=>{g("request",{pagination:l.pagination||f.value,filter:l.filter||o.filter,getCellValue:a})})}function m(l,v){const c=rt({...f.value,...l});if(ql(f.value,c)===!0){r.value===!0&&v===!0&&u(c);return}if(r.value===!0){u(c);return}o.pagination!==void 0&&o["onUpdate:pagination"]!==void 0?g("update:pagination",c):n.value=c}return{innerPagination:n,computedPagination:f,isServerSide:r,requestServerInteraction:i,setPagination:m}}function pl(e,a,o,g,n,f){const{props:r,emit:u,proxy:{$q:i}}=e,m=b(()=>g.value===!0?o.value.rowsNumber||0:f.value),l=b(()=>{const{page:R,rowsPerPage:O}=o.value;return(R-1)*O}),v=b(()=>{const{page:R,rowsPerPage:O}=o.value;return R*O}),c=b(()=>o.value.page===1),y=b(()=>o.value.rowsPerPage===0?1:Math.max(1,Math.ceil(m.value/o.value.rowsPerPage))),P=b(()=>v.value===0?!0:o.value.page>=y.value),k=b(()=>(r.rowsPerPageOptions.includes(a.value.rowsPerPage)?r.rowsPerPageOptions:[a.value.rowsPerPage].concat(r.rowsPerPageOptions)).map(O=>({label:O===0?i.lang.table.allRows:""+O,value:O})));V(y,(R,O)=>{if(R===O)return;const ne=o.value.page;R&&!ne?n({page:1}):R<ne&&n({page:R})});function w(){n({page:1})}function $(){const{page:R}=o.value;R>1&&n({page:R-1})}function D(){const{page:R,rowsPerPage:O}=o.value;v.value>0&&R*O<m.value&&n({page:R+1})}function L(){n({page:y.value})}return r["onUpdate:pagination"]!==void 0&&u("update:pagination",{...o.value}),{firstRowIndex:l,lastRowIndex:v,isFirstPage:c,isLastPage:P,pagesNumber:y,computedRowsPerPageOptions:k,computedRowsNumber:m,firstPage:w,prevPage:$,nextPage:D,lastPage:L}}const Tl={selection:{type:String,default:"none",validator:e=>["single","multiple","none"].includes(e)},selected:{type:Array,default:()=>[]}},xl=["update:selected","selection"];function Rl(e,a,o,g){const n=b(()=>{const P={};return e.selected.map(g.value).forEach(k=>{P[k]=!0}),P}),f=b(()=>e.selection!=="none"),r=b(()=>e.selection==="single"),u=b(()=>e.selection==="multiple"),i=b(()=>o.value.length!==0&&o.value.every(P=>n.value[g.value(P)]===!0)),m=b(()=>i.value!==!0&&o.value.some(P=>n.value[g.value(P)]===!0)),l=b(()=>e.selected.length);function v(P){return n.value[P]===!0}function c(){a("update:selected",[])}function y(P,k,w,$){a("selection",{rows:k,added:w,keys:P,evt:$});const D=r.value===!0?w===!0?k:[]:w===!0?e.selected.concat(k):e.selected.filter(L=>P.includes(g.value(L))===!1);a("update:selected",D)}return{hasSelectionMode:f,singleSelection:r,multipleSelection:u,allRowsSelected:i,someRowsSelected:m,rowsSelectedNumber:l,isRowSelected:v,clearSelection:c,updateSelection:y}}function it(e){return Array.isArray(e)?e.slice():[]}const Bl={expanded:Array},Ol=["update:expanded"];function Fl(e,a){const o=E(it(e.expanded));V(()=>e.expanded,r=>{o.value=it(r)});function g(r){return o.value.includes(r)}function n(r){e.expanded!==void 0?a("update:expanded",r):o.value=r}function f(r,u){const i=o.value.slice(),m=i.indexOf(r);u===!0?m===-1&&(i.push(r),n(i)):m!==-1&&(i.splice(m,1),n(i))}return{isRowExpanded:g,setExpanded:n,updateExpanded:f}}const $l={visibleColumns:Array};function Dl(e,a,o){const g=b(()=>{if(e.columns!==void 0)return e.columns;const u=e.rows[0];return u!==void 0?Object.keys(u).map(i=>({name:i,label:i.toUpperCase(),field:i,align:De(u[i])?"right":"left",sortable:!0})):[]}),n=b(()=>{const{sortBy:u,descending:i}=a.value;return(e.visibleColumns!==void 0?g.value.filter(l=>l.required===!0||e.visibleColumns.includes(l.name)===!0):g.value).map(l=>{const v=l.align||"right",c=`text-${v}`;return{...l,align:v,__iconClass:`q-table__sort-icon q-table__sort-icon--${v}`,__thClass:c+(l.headerClasses!==void 0?" "+l.headerClasses:"")+(l.sortable===!0?" sortable":"")+(l.name===u?` sorted ${i===!0?"sort-desc":""}`:""),__tdStyle:l.style!==void 0?typeof l.style!="function"?()=>l.style:l.style:()=>null,__tdClass:l.classes!==void 0?typeof l.classes!="function"?()=>c+" "+l.classes:y=>c+" "+l.classes(y):()=>c}})}),f=b(()=>{const u={};return n.value.forEach(i=>{u[i.name]=i}),u}),r=b(()=>e.tableColspan!==void 0?e.tableColspan:n.value.length+(o.value===!0?1:0));return{colList:g,computedCols:n,computedColsMap:f,computedColspan:r}}const be="q-table__bottom row items-center",bt={};ft.forEach(e=>{bt[e]={}});var Al=W({name:"QTable",props:{rows:{type:Array,default:()=>[]},rowKey:{type:[String,Function],default:"id"},columns:Array,loading:Boolean,iconFirstPage:String,iconPrevPage:String,iconNextPage:String,iconLastPage:String,title:String,hideHeader:Boolean,grid:Boolean,gridHeader:Boolean,dense:Boolean,flat:Boolean,bordered:Boolean,square:Boolean,separator:{type:String,default:"horizontal",validator:e=>["horizontal","vertical","cell","none"].includes(e)},wrapCells:Boolean,virtualScroll:Boolean,virtualScrollTarget:{default:void 0},...bt,noDataLabel:String,noResultsLabel:String,loadingLabel:String,selectedRowsLabel:Function,rowsPerPageLabel:String,paginationLabel:Function,color:{type:String,default:"grey-8"},titleClass:[String,Array,Object],tableStyle:[String,Array,Object],tableClass:[String,Array,Object],tableHeaderStyle:[String,Array,Object],tableHeaderClass:[String,Array,Object],cardContainerClass:[String,Array,Object],cardContainerStyle:[String,Array,Object],cardStyle:[String,Array,Object],cardClass:[String,Array,Object],hideBottom:Boolean,hideSelectedBanner:Boolean,hideNoData:Boolean,hidePagination:Boolean,onRowClick:Function,onRowDblclick:Function,onRowContextmenu:Function,...Ne,...bl,...$l,...hl,...Pl,...Bl,...Tl,...Sl},emits:["request","virtualScroll",...ml,...Ol,...xl],setup(e,{slots:a,emit:o}){const g=Z(),{proxy:{$q:n}}=g,f=Ve(e,n),{inFullscreen:r,toggleFullscreen:u}=_l(),i=b(()=>typeof e.rowKey=="function"?e.rowKey:t=>t[e.rowKey]),m=E(null),l=E(null),v=b(()=>e.grid!==!0&&e.virtualScroll===!0),c=b(()=>" q-table__card"+(f.value===!0?" q-table__card--dark q-dark":"")+(e.square===!0?" q-table--square":"")+(e.flat===!0?" q-table--flat":"")+(e.bordered===!0?" q-table--bordered":"")),y=b(()=>`q-table__container q-table--${e.separator}-separator column no-wrap`+(e.grid===!0?" q-table--grid":c.value)+(f.value===!0?" q-table--dark":"")+(e.dense===!0?" q-table--dense":"")+(e.wrapCells===!1?" q-table--no-wrap":"")+(r.value===!0?" fullscreen scroll":"")),P=b(()=>y.value+(e.loading===!0?" q-table--loading":""));V(()=>e.tableStyle+e.tableClass+e.tableHeaderStyle+e.tableHeaderClass+y.value,()=>{v.value===!0&&l.value!==null&&l.value.reset()});const{innerPagination:k,computedPagination:w,isServerSide:$,requestServerInteraction:D,setPagination:L}=Cl(g,X),{computedFilterMethod:R}=kl(e,L),{isRowExpanded:O,setExpanded:ne,updateExpanded:mt}=Fl(e,o),me=b(()=>{let t=e.rows;if($.value===!0||t.length===0)return t;const{sortBy:d,descending:_}=w.value;return e.filter&&(t=R.value(t,e.filter,M.value,X)),ht.value!==null&&(t=kt.value(e.rows===t?t.slice():t,d,_)),t}),Me=b(()=>me.value.length),Q=b(()=>{let t=me.value;if($.value===!0)return t;const{rowsPerPage:d}=w.value;return d!==0&&(ie.value===0&&e.rows!==t?t.length>se.value&&(t=t.slice(0,se.value)):t=t.slice(ie.value,se.value)),t}),{hasSelectionMode:G,singleSelection:_t,multipleSelection:je,allRowsSelected:yt,someRowsSelected:Qe,rowsSelectedNumber:_e,isRowSelected:ye,clearSelection:St,updateSelection:re}=Rl(e,o,Q,i),{colList:wt,computedCols:M,computedColsMap:ze,computedColspan:He}=Dl(e,w,G),{columnToSort:ht,computedSortMethod:kt,sort:Se}=wl(e,w,wt,L),{firstRowIndex:ie,lastRowIndex:se,isFirstPage:we,isLastPage:he,pagesNumber:ue,computedRowsPerPageOptions:qt,computedRowsNumber:ce,firstPage:ke,prevPage:qe,nextPage:Pe,lastPage:Ce}=pl(g,k,w,$,L,Me),Pt=b(()=>Q.value.length===0),Ct=b(()=>{const t={};return ft.forEach(d=>{t[d]=e[d]}),t.virtualScrollItemSize===void 0&&(t.virtualScrollItemSize=e.dense===!0?28:48),t});function pt(){v.value===!0&&l.value.reset()}function Tt(){if(e.grid===!0)return Vt();const t=e.hideHeader!==!0?Ge:null;if(v.value===!0){const _=a["top-row"],S=a["bottom-row"],h={default:x=>Ie(x.item,a.body,x.index)};if(_!==void 0){const x=s("tbody",_({cols:M.value}));h.before=t===null?()=>x:()=>[t()].concat(x)}else t!==null&&(h.before=t);return S!==void 0&&(h.after=()=>s("tbody",S({cols:M.value}))),s(vl,{ref:l,class:e.tableClass,style:e.tableStyle,...Ct.value,scrollTarget:e.virtualScrollTarget,items:Q.value,type:"__qtable",tableColspan:He.value,onVirtualScroll:Rt},h)}const d=[Bt()];return t!==null&&d.unshift(t()),gt({class:["q-table__middle scroll",e.tableClass],style:e.tableStyle},d)}function xt(t,d){if(l.value!==null){l.value.scrollTo(t,d);return}t=parseInt(t,10);const _=m.value.querySelector(`tbody tr:nth-of-type(${t+1})`);if(_!==null){const S=m.value.querySelector(".q-table__middle.scroll"),h=_.offsetTop-e.virtualScrollStickySizeStart,x=h<S.scrollTop?"decrease":"increase";S.scrollTop=h,o("virtualScroll",{index:t,from:0,to:k.value.rowsPerPage-1,direction:x})}}function Rt(t){o("virtualScroll",t)}function Ke(){return[s(gl,{class:"q-table__linear-progress",color:e.color,dark:f.value,indeterminate:!0,trackColor:"transparent"})]}function Ie(t,d,_){const S=i.value(t),h=ye(S);if(d!==void 0)return d(Ue({key:S,row:t,pageIndex:_,__trClass:h?"selected":""}));const x=a["body-cell"],T=M.value.map(F=>{const ve=a[`body-cell-${F.name}`],fe=ve!==void 0?ve:x;return fe!==void 0?fe(Ot({key:S,row:t,pageIndex:_,col:F})):s("td",{class:F.__tdClass(t),style:F.__tdStyle(t)},X(F,t))});if(G.value===!0){const F=a["body-selection"],ve=F!==void 0?F(Ft({key:S,row:t,pageIndex:_})):[s(Fe,{modelValue:h,color:e.color,dark:f.value,dense:e.dense,"onUpdate:modelValue":(fe,Mt)=>{re([S],[t],fe,Mt)}})];T.unshift(s("td",{class:"q-table--col-auto-width"},ve))}const j={key:S,class:{selected:h}};return e.onRowClick!==void 0&&(j.class["cursor-pointer"]=!0,j.onClick=F=>{o("RowClick",F,t,_)}),e.onRowDblclick!==void 0&&(j.class["cursor-pointer"]=!0,j.onDblclick=F=>{o("RowDblclick",F,t,_)}),e.onRowContextmenu!==void 0&&(j.class["cursor-pointer"]=!0,j.onContextmenu=F=>{o("RowContextmenu",F,t,_)}),s("tr",j,T)}function Bt(){const t=a.body,d=a["top-row"],_=a["bottom-row"];let S=Q.value.map((h,x)=>Ie(h,t,x));return d!==void 0&&(S=d({cols:M.value}).concat(S)),_!==void 0&&(S=S.concat(_({cols:M.value}))),s("tbody",S)}function Ue(t){return pe(t),t.cols=t.cols.map(d=>ee({...d},"value",()=>X(d,t.row))),t}function Ot(t){return pe(t),ee(t,"value",()=>X(t.col,t.row)),t}function Ft(t){return pe(t),t}function pe(t){Object.assign(t,{cols:M.value,colsMap:ze.value,sort:Se,rowIndex:ie.value+t.pageIndex,color:e.color,dark:f.value,dense:e.dense}),G.value===!0&&ee(t,"selected",()=>ye(t.key),(d,_)=>{re([t.key],[t.row],d,_)}),ee(t,"expand",()=>O(t.key),d=>{mt(t.key,d)})}function X(t,d){const _=typeof t.field=="function"?t.field(d):d[t.field];return t.format!==void 0?t.format(_,d):_}const Y=b(()=>({pagination:w.value,pagesNumber:ue.value,isFirstPage:we.value,isLastPage:he.value,firstPage:ke,prevPage:qe,nextPage:Pe,lastPage:Ce,inFullscreen:r.value,toggleFullscreen:u}));function $t(){const t=a.top,d=a["top-left"],_=a["top-right"],S=a["top-selection"],h=G.value===!0&&S!==void 0&&_e.value>0,x="q-table__top relative-position row items-center";if(t!==void 0)return s("div",{class:x},[t(Y.value)]);let T;if(h===!0?T=S(Y.value).slice():(T=[],d!==void 0?T.push(s("div",{class:"q-table__control"},[d(Y.value)])):e.title&&T.push(s("div",{class:"q-table__control"},[s("div",{class:["q-table__title",e.titleClass]},e.title)]))),_!==void 0&&(T.push(s("div",{class:"q-table__separator col"})),T.push(s("div",{class:"q-table__control"},[_(Y.value)]))),T.length!==0)return s("div",{class:x},T)}const We=b(()=>Qe.value===!0?null:yt.value);function Ge(){const t=Dt();return e.loading===!0&&a.loading===void 0&&t.push(s("tr",{class:"q-table__progress"},[s("th",{class:"relative-position",colspan:He.value},Ke())])),s("thead",t)}function Dt(){const t=a.header,d=a["header-cell"];if(t!==void 0)return t(Te({header:!0})).slice();const _=M.value.map(S=>{const h=a[`header-cell-${S.name}`],x=h!==void 0?h:d,T=Te({col:S});return x!==void 0?x(T):s(il,{key:S.name,props:T},()=>S.label)});if(_t.value===!0&&e.grid!==!0)_.unshift(s("th",{class:"q-table--col-auto-width"}," "));else if(je.value===!0){const S=a["header-selection"],h=S!==void 0?S(Te({})):[s(Fe,{color:e.color,modelValue:We.value,dark:f.value,dense:e.dense,"onUpdate:modelValue":Xe})];_.unshift(s("th",{class:"q-table--col-auto-width"},h))}return[s("tr",{class:e.tableHeaderClass,style:e.tableHeaderStyle},_)]}function Te(t){return Object.assign(t,{cols:M.value,sort:Se,colsMap:ze.value,color:e.color,dark:f.value,dense:e.dense}),je.value===!0&&ee(t,"selected",()=>We.value,Xe),t}function Xe(t){Qe.value===!0&&(t=!1),re(Q.value.map(i.value),Q.value,t)}const de=b(()=>{const t=[e.iconFirstPage||n.iconSet.table.firstPage,e.iconPrevPage||n.iconSet.table.prevPage,e.iconNextPage||n.iconSet.table.nextPage,e.iconLastPage||n.iconSet.table.lastPage];return n.lang.rtl===!0?t.reverse():t});function At(){if(e.hideBottom===!0)return;if(Pt.value===!0){if(e.hideNoData===!0)return;const _=e.loading===!0?e.loadingLabel||n.lang.table.loading:e.filter?e.noResultsLabel||n.lang.table.noResults:e.noDataLabel||n.lang.table.noData,S=a["no-data"],h=S!==void 0?[S({message:_,icon:n.iconSet.table.warning,filter:e.filter})]:[s(oe,{class:"q-table__bottom-nodata-icon",name:n.iconSet.table.warning}),_];return s("div",{class:be+" q-table__bottom--nodata"},h)}const t=a.bottom;if(t!==void 0)return s("div",{class:be},[t(Y.value)]);const d=e.hideSelectedBanner!==!0&&G.value===!0&&_e.value>0?[s("div",{class:"q-table__control"},[s("div",[(e.selectedRowsLabel||n.lang.table.selectedRecords)(_e.value)])])]:[];if(e.hidePagination!==!0)return s("div",{class:be+" justify-end"},Lt(d));if(d.length!==0)return s("div",{class:be},d)}function Et(t){L({page:1,rowsPerPage:t.value})}function Lt(t){let d;const{rowsPerPage:_}=w.value,S=e.paginationLabel||n.lang.table.pagination,h=a.pagination,x=e.rowsPerPageOptions.length>1;if(t.push(s("div",{class:"q-table__separator col"})),x===!0&&t.push(s("div",{class:"q-table__control"},[s("span",{class:"q-table__bottom-item"},[e.rowsPerPageLabel||n.lang.table.recordsPerPage]),s(rl,{class:"q-table__select inline q-table__bottom-item",color:e.color,modelValue:_,options:qt.value,displayValue:_===0?n.lang.table.allRows:_,dark:f.value,borderless:!0,dense:!0,optionsDense:!0,optionsCover:!0,"onUpdate:modelValue":Et})])),h!==void 0)d=h(Y.value);else if(d=[s("span",_!==0?{class:"q-table__bottom-item"}:{},[_?S(ie.value+1,Math.min(se.value,ce.value),ce.value):S(1,Me.value,ce.value)])],_!==0&&ue.value>1){const T={color:e.color,round:!0,dense:!0,flat:!0};e.dense===!0&&(T.size="sm"),ue.value>2&&d.push(s(H,{key:"pgFirst",...T,icon:de.value[0],disable:we.value,onClick:ke})),d.push(s(H,{key:"pgPrev",...T,icon:de.value[1],disable:we.value,onClick:qe}),s(H,{key:"pgNext",...T,icon:de.value[2],disable:he.value,onClick:Pe})),ue.value>2&&d.push(s(H,{key:"pgLast",...T,icon:de.value[3],disable:he.value,onClick:Ce}))}return t.push(s("div",{class:"q-table__control"},d)),t}function Nt(){const t=e.gridHeader===!0?[s("table",{class:"q-table"},[Ge()])]:e.loading===!0&&a.loading===void 0?Ke():void 0;return s("div",{class:"q-table__middle"},t)}function Vt(){const t=a.item!==void 0?a.item:d=>{const _=d.cols.map(h=>s("div",{class:"q-table__grid-item-row"},[s("div",{class:"q-table__grid-item-title"},[h.label]),s("div",{class:"q-table__grid-item-value"},[h.value])]));if(G.value===!0){const h=a["body-selection"],x=h!==void 0?h(d):[s(Fe,{modelValue:d.selected,color:e.color,dark:f.value,dense:e.dense,"onUpdate:modelValue":(T,j)=>{re([d.key],[d.row],T,j)}})];_.unshift(s("div",{class:"q-table__grid-item-row"},x),s(Ee,{dark:f.value}))}const S={class:["q-table__grid-item-card"+c.value,e.cardClass],style:e.cardStyle};return(e.onRowClick!==void 0||e.onRowDblclick!==void 0)&&(S.class[0]+=" cursor-pointer",e.onRowClick!==void 0&&(S.onClick=h=>{o("RowClick",h,d.row,d.pageIndex)}),e.onRowDblclick!==void 0&&(S.onDblclick=h=>{o("RowDblclick",h,d.row,d.pageIndex)})),s("div",{class:"q-table__grid-item col-xs-12 col-sm-6 col-md-4 col-lg-3"+(d.selected===!0?" q-table__grid-item--selected":"")},[s("div",S,_)])};return s("div",{class:["q-table__grid-content row",e.cardContainerClass],style:e.cardContainerStyle},Q.value.map((d,_)=>t(Ue({key:i.value(d),row:d,pageIndex:_}))))}return Object.assign(g.proxy,{requestServerInteraction:D,setPagination:L,firstPage:ke,prevPage:qe,nextPage:Pe,lastPage:Ce,isRowSelected:ye,clearSelection:St,isRowExpanded:O,setExpanded:ne,sort:Se,resetVirtualScroll:pt,scrollTo:xt,getCellValue:X}),Yt(g.proxy,{filteredSortedRows:()=>me.value,computedRows:()=>Q.value,computedRowsNumber:()=>ce.value}),()=>{const t=[$t()],d={ref:m,class:P.value};return e.grid===!0?t.push(Nt()):Object.assign(d,{class:[d.class,e.cardClass],style:e.cardStyle}),t.push(Tt(),At()),e.loading===!0&&a.loading!==void 0&&t.push(a.loading()),s("div",d,t)}}});const El=vt({__name:"CancelEscrowButton",props:["escrow_address","label"],setup(e){const a=e,o=Ae();async function g(){const n=Jt().pg_escrow;let f;f=o.notify({group:!1,timeout:0,spinner:!0,message:"Sending TX..."});try{const r=await n.value.account.escrow.fetch(a.escrow_address),u=r.seed,i=te.findProgramAddressSync([ge.Buffer.from("auth")],n.value.programId)[0],m=te.findProgramAddressSync([ge.Buffer.from("escrow"),K().publicKey.value.toBytes(),u.toArrayLike(ge.Buffer).reverse(),,],n.value.programId)[0],l=te.findProgramAddressSync([ge.Buffer.from("vault"),m.toBuffer()],n.value.programId)[0],v=Ye(new te(r.depositToken),K().publicKey.value,void 0,Re,Be),c=Ye(new te(r.requestToken),K().publicKey.value,void 0,Re,Be);let y=await n.value.methods.cancel().accounts({maker:K().publicKey.value,makerAta:v,depositToken:r.depositToken,makerAtaRequest:c,makerTokenRequest:r.requestToken,auth:i,escrow:m,vault:l,tokenProgram:Re,associatedTokenProgram:Be,systemProgram:Zt.programId});y=await y.rpc(),console.log(`TX_Signature = ${y}`),await jt(p().connection,y),f({type:"positive",icon:"done",spinner:!1,message:"Transaction confirmed!",timeout:2500})}catch(r){f({type:"negative",icon:"error",spinner:!1,message:r.toString(),timeout:5e3}),console.error(r)}}return(n,f)=>(I(),U(H,{icon:"close",class:"col",color:"primary",label:e.label,onClick:f[0]||(f[0]=r=>{g().then(()=>{console.info("build_tx executed")})})},null,8,["label"]))}});const Ll={class:"col items-center"},Nl=N("div",{class:"q-my-md"},null,-1),Vl={class:"col"},Ml={class:"text-right text-h6"},jl={class:"col text-right text-h6"},Ql={class:"col items-center q-gutter-x-sm"},zl={style:{"font-size":"10px"}},Hl={class:"col items-center q-gutter-x-sm"},Kl={style:{"font-size":"10px"}},Il={class:"text-h5 text-weight-bold"},Zl=vt({__name:"EscrowTable",props:["title","escrow_filter","show_close_button"],setup(e){const a=e,o=E(!1);Ae(),b(()=>{var m,l,v;let i=p().escrows;switch(a.escrow_filter){case"p2p":i=(m=p().escrows)==null?void 0:m.filter(c=>{var y,P;return c.account.recipient.toString()!=lt.toString()&&(c.account.maker.toString()==((y=K().publicKey.value)==null?void 0:y.toString())||c.account.recipient.toString()==((P=K().publicKey.value)==null?void 0:P.toString()))});break;case"b2b":i=(l=p().escrows)==null?void 0:l.filter(c=>c.account.onlyWhitelist==!0);break;default:i=(v=p().escrows)==null?void 0:v.filter(c=>c.account.recipient.toString()==lt.toString()&&c.account.onlyWhitelist!=!0&&c.account.tokensDepositRemaining.toNumber()>0);break}return u.value&&(r.value.some(c=>c=="buying")&&(console.log(u.value.mint.toString()),i=i==null?void 0:i.filter(c=>c.account.depositToken.toString()==u.value.mint.toString())),r.value.some(c=>c=="selling")&&(console.log(u.value.mint.toString()),i=i==null?void 0:i.filter(c=>c.account.requestToken.toString()===u.value.mint.toString()))),i}),V(()=>p().is_initialized,async()=>{await p().load_all_escrows()}),Le(async()=>{p().is_initialized&&await p().load_all_escrows()});function g(i){var m;a.show_close_button?(p().escrow_selected=i,o.value=!o.value):i.publicKey!=((m=p().escrow_selected)==null?void 0:m.publicKey)?(p().escrow_selected=i,p().showRightDrawer=!0):p().showRightDrawer=!p().showRightDrawer}const n=E({rowsPerPage:0}),f=E([{name:"sides",label:"",style:"width: 20px"},{name:"amounts",label:"Amounts"},{name:"icons",label:"Tokens",align:"center",style:"width: 50px"},{name:"price",label:"Price per Unit",align:"center"},{name:"balance",label:"",style:"width: 20px"},{name:"expire",label:"",style:"width: 20px"},{name:"creator",label:"",style:"width: 20px"},{name:"state",label:"",style:"width: 20px"},{name:"take",label:"",style:"width: 20px"}]);E([{label:"Buying",value:"buying"},{label:"Selling",value:"selling"}]);const r=E([]),u=E();return(i,m)=>(I(),U(Al,{flat:"",title:a.title,rows:B(p)().escrows_filtered,columns:f.value,"row-key":"name",filter:i.filter,pagination:n.value,"onUpdate:pagination":m[0]||(m[0]=l=>n.value=l),"rows-per-page-options":[0]},{top:C(()=>[]),body:C(l=>[q($e,{props:l,onClick:v=>g(l.row)},{default:C(()=>[q(A,{key:"sides",props:l},{default:C(()=>[N("div",Ll,[q(Je,{outline:"",label:"SELL",color:"red",rounded:""}),Nl,q(Je,{outline:"",label:"BUY",color:"green",rounded:""})])]),_:2},1032,["props"]),q(A,{key:"amounts",props:l},{default:C(()=>{var v,c;return[N("div",Vl,[N("div",Ml,z((l.row.account.tokensDepositRemaining*10**-((v=B(p)().token_list.find(y=>y.address==l.row.account.depositToken.toString()))==null?void 0:v.decimals)*l.row.account.price).toFixed(2)),1),q(Ee,{class:"q-my-sm"}),N("div",jl,z((l.row.account.tokensDepositRemaining*Math.pow(10,-((c=B(p)().token_list.find(y=>y.address==l.row.account.depositToken.toString()))==null?void 0:c.decimals))).toFixed(2)),1)])]}),_:2},1032,["props"]),q(A,{key:"icons",props:l},{default:C(()=>{var v;return[N("div",Ql,[q(at,{size:"md"},{default:C(()=>{var c;return[q(ot,{src:((c=B(p)().token_list.find(y=>y.address==l.row.account.requestToken.toString()))==null?void 0:c.logoURI)??"unknown.png"},null,8,["src"])]}),_:2},1024),N("p",zl,z(B(p)().token_list.find(c=>c.address==l.row.account.requestToken.toString()).symbol),1)]),N("div",Hl,[q(at,{size:"md"},{default:C(()=>{var c;return[q(ot,{src:((c=B(p)().token_list.find(y=>y.address==l.row.account.depositToken.toString()))==null?void 0:c.logoURI)??"unknown.png"},null,8,["src"])]}),_:2},1024),N("div",Kl,z((v=B(p)().token_list.find(c=>c.address==l.row.account.depositToken.toString()))==null?void 0:v.symbol),1)])]}),_:2},1032,["props"]),q(A,{key:"price",props:l},{default:C(()=>[N("div",Il,z(l.row.account.price.toFixed(5)),1)]),_:2},1032,["props"]),q(A,{key:"balance",props:l},{default:C(()=>[q(oe,{size:"sm",name:"balance",color:l.row.account.allowPartialFill?"purple":"grey"},{default:C(()=>[q(xe,null,{default:C(()=>[Oe("Partial fill "+z(l.row.account.allowPartialFill?"":"NOT ")+" allowed",1)]),_:2},1024)]),_:2},1032,["color"])]),_:2},1032,["props"]),q(A,{key:"expire",props:l},{default:C(()=>[q(oe,{size:"sm",name:"timer",color:l.row.account.expireTimestamp>0?"orange":"grey"},{default:C(()=>[q(xe,null,{default:C(()=>[Oe("Will "+z(l.row.account.expireTimestamp>0?"":"NOT ")+" expire",1)]),_:2},1024)]),_:2},1032,["color"])]),_:2},1032,["props"]),q(A,{key:"creator",props:l},{default:C(()=>{var v;return[q(oe,{size:"sm",name:"design_services",color:l.row.account.maker.toString()==((v=B(K)().publicKey.value)==null?void 0:v.toString())?"orange":"grey"},{default:C(()=>[q(xe,null,{default:C(()=>{var c;return[Oe("You are "+z(l.row.account.maker.toString()==((c=B(K)().publicKey.value)==null?void 0:c.toString())?"":"NOT ")+" the creator",1)]}),_:2},1024)]),_:2},1032,["color"])]}),_:2},1032,["props"]),q(A,{key:"state",props:l},{default:C(()=>[q(Qt,{escrow:l.row},null,8,["escrow"])]),_:2},1032,["props"]),e.show_close_button?le("",!0):(I(),U(A,{key:"take",props:l},{default:C(()=>[q(H,{color:"primary",icon:"send"})]),_:2},1032,["props"])),e.show_close_button?(I(),U(A,{key:"take",props:l},{default:C(()=>[q(H,{color:"primary",icon:"info"})]),_:2},1032,["props"])):le("",!0)]),_:2},1032,["props","onClick"]),o.value&&l.row.publicKey==B(p)().escrow_selected.publicKey.toString()?(I(),U($e,{key:0,props:l},{default:C(()=>[q(A,{colspan:"100%"},{default:C(()=>[q(ll,{class:"bg-dark",align:"justify"},{default:C(()=>{var v;return[q(H,{class:"col",color:"primary",label:"Expand offer",name:"tab_expand",icon:"open_in_full",to:"view/"+((v=B(p)().escrow_selected)==null?void 0:v.publicKey)},null,8,["to"]),q(Ee,{vertical:""}),q(El,{escrow_address:l.row.publicKey,label:`${l.row.account.tokensDepositRemaining>0?"Cancel Offer":"Close Accounts"} (+${B(el)}sol)`},null,8,["escrow_address","label"])]}),_:2},1024)]),_:2},1024)]),_:2},1032,["props"])):le("",!0),B(Ae)().screen.lt.md&&B(p)().showRightDrawer&&l.row.publicKey==B(p)().escrow_selected.publicKey.toString()?(I(),U($e,{key:1,"no-hover":"",props:l},{default:C(()=>[e.show_close_button?le("",!0):(I(),U(A,{key:0,colspan:"100%",class:"bg-dark q-ma-none q-pa-none"},{default:C(()=>[q(al)]),_:1}))]),_:2},1032,["props"])):le("",!0)]),_:1},8,["title","rows","columns","filter","pagination"]))}});export{Zl as _};
